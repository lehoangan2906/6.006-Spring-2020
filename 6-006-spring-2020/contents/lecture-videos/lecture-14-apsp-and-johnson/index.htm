<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 14: APSP and Johnson | Lecture Videos | Introduction to Algorithms | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-006-introduction-to-algorithms-spring-2020" name="WT.cg_n">
    <meta content="Lecture 14: APSP and Johnson" name="WT.cg_s">
    <meta content="" name="Description">
    <meta content="Demaine, Erik" name="Author">
    <meta content="Ku, Jason" name="Author">
    <meta content="Solomon, Justin" name="Author">
    <meta content="6.006,data structure,sorting,hashing,binary trees,breadth-first search,depth-first search,weighted shortest path,Bellman-Ford,Dijkstra,dynamic programming,recursion,complexity,algorithms,computational programs,analysis,proofs,Algorithms and Data Structures,Theory of Computation" name="keywords">
    <meta content="6.006 Introduction to Algorithms | Lecture 14: APSP and Johnson" name="Search_Display">
    <meta content="Algorithms and Data Structures" itemprop="about">
    <meta content="Theory of Computation" itemprop="about">
    <meta content="Computation" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-spring-2020/lecture-videos/lecture-14-apsp-and-johnson/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Introduction to Algorithms</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/lecture-videos/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 14: APSP and Johnson
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 14: APSP and Johnson
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/lecture-videos/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/quizzes/index.htm">
		                  Quizzes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/practice-problems/index.htm">
		                  Practice Problems  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/assignments/index.htm">
		                  Assignments  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/resource-index/index.htm">
		                  Resource Index  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-spring-2020/lecture-videos/lecture-14-apsp-and-johnson/EmSmaW-ud6A.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://archive.org/download/MIT6.006S20/MIT6_006S20_04_09_Lecture_14_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/EmSmaW-ud6A', 'youtube', '/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-spring-2020/lecture-videos/lecture-14-apsp-and-johnson', 'https://img.youtube.com/vi/EmSmaW-ud6A/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-spring-2020/lecture-videos/lecture-14-apsp-and-johnson/EmSmaW-ud6A.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 6476801, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/lecture-videos/problem-session-7/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/lecture-videos/quiz-2-review/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p>This lecture focuses on solving any all-pairs shortest paths (APSP) in weighted graphs. Johnson's algorithm is introduced.</p>
<p><strong>Instructor:</strong> Jason Ku</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-1-algorithms-and-computation/index.htm">
<img src="https://img.youtube.com/vi/ZA-tUyM_y7s/default.jpg" title="Lecture 1: Algorithms and Computation" alt="Lecture 1: Algorithms and Computation">
<p>Lecture 1: Algorithms and C...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-2-data-structures-and-dynamic-arrays/index.htm">
<img src="https://img.youtube.com/vi/CHhwJjR0mZA/default.jpg" title="Lecture 2: Data Structures and Dynamic Arrays" alt="Lecture 2: Data Structures and Dynamic Arrays">
<p>Lecture 2: Data Structures ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-1/index.htm">
<img src="https://img.youtube.com/vi/IPSaG9RRc-k/default.jpg" title="Problem Session 1" alt="Problem Session 1">
<p>Problem Session 1</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-3-sets-and-sorting/index.htm">
<img src="https://img.youtube.com/vi/oS9aPzUNG-s/default.jpg" title="Lecture 3: Sets and Sorting" alt="Lecture 3: Sets and Sorting">
<p>Lecture 3: Sets and Sorting</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-4-hashing/index.htm">
<img src="https://img.youtube.com/vi/Nu8YGneFCWE/default.jpg" title="Lecture 4: Hashing" alt="Lecture 4: Hashing">
<p>Lecture 4: Hashing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-2/index.htm">
<img src="https://img.youtube.com/vi/KlQiwkhLBg0/default.jpg" title="Problem Session 2" alt="Problem Session 2">
<p>Problem Session 2</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-5-linear-sorting/index.htm">
<img src="https://img.youtube.com/vi/yndgIDO0zQQ/default.jpg" title="Lecture 5: Linear Sorting" alt="Lecture 5: Linear Sorting">
<p>Lecture 5: Linear Sorting</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-3/index.htm">
<img src="https://img.youtube.com/vi/g0bXSXuLVb0/default.jpg" title="Problem Session 3" alt="Problem Session 3">
<p>Problem Session 3</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-6-binary-trees-part-1/index.htm">
<img src="https://img.youtube.com/vi/76dhtgZt38A/default.jpg" title="Lecture 6: Binary Trees, Part 1" alt="Lecture 6: Binary Trees, Part 1">
<p>Lecture 6: Binary Trees, Pa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-7-binary-trees-part-2-avl/index.htm">
<img src="https://img.youtube.com/vi/U1JYwHcFfso/default.jpg" title="Lecture 7: Binary Trees, Part 2: AVL" alt="Lecture 7: Binary Trees, Part 2: AVL">
<p>Lecture 7: Binary Trees, Pa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-4/index.htm">
<img src="https://img.youtube.com/vi/MAyraVVYB64/default.jpg" title="Problem Session 4" alt="Problem Session 4">
<p>Problem Session 4</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-8-binary-heaps/index.htm">
<img src="https://img.youtube.com/vi/Xnpo1atN-Iw/default.jpg" title="Lecture 8: Binary Heaps" alt="Lecture 8: Binary Heaps">
<p>Lecture 8: Binary Heaps</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-9-breadth-first-search/index.htm">
<img src="https://img.youtube.com/vi/oFVYVzlvk9c/default.jpg" title="Lecture 9: Breadth-First Search" alt="Lecture 9: Breadth-First Search">
<p>Lecture 9: Breadth-First Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/quiz-1-review/index.htm">
<img src="https://img.youtube.com/vi/e98MPnMHLxE/default.jpg" title="Quiz 1 Review" alt="Quiz 1 Review">
<p>Quiz 1 Review</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-10-depth-first-search/index.htm">
<img src="https://img.youtube.com/vi/IBfWDYSffUU/default.jpg" title="Lecture 10: Depth-First Search" alt="Lecture 10: Depth-First Search">
<p>Lecture 10: Depth-First Search</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-11-weighted-shortest-paths/index.htm">
<img src="https://img.youtube.com/vi/5cF5Bgv59Sc/default.jpg" title="Lecture 11: Weighted Shortest Paths" alt="Lecture 11: Weighted Shortest Paths">
<p>Lecture 11: Weighted Shorte...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-5/index.htm">
<img src="https://img.youtube.com/vi/ZLdooNwP7Pw/default.jpg" title="Problem Session 5" alt="Problem Session 5">
<p>Problem Session 5</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-12-bellman-ford/index.htm">
<img src="https://img.youtube.com/vi/f9cVS_URPc0/default.jpg" title="Lecture 12: Bellman-Ford" alt="Lecture 12: Bellman-Ford">
<p>Lecture 12: Bellman-Ford</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-6/index.htm">
<img src="https://img.youtube.com/vi/kshe8d8rxHo/default.jpg" title="Problem Session 6" alt="Problem Session 6">
<p>Problem Session 6</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-13-dijkstra/index.htm">
<img src="https://img.youtube.com/vi/NSHizBK9JD8/default.jpg" title="Lecture 13: Dijkstra" alt="Lecture 13: Dijkstra">
<p>Lecture 13: Dijkstra</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-7/index.htm">
<img src="https://img.youtube.com/vi/WO6vQJ6Rhm8/default.jpg" title="Problem Session 7" alt="Problem Session 7">
<p>Problem Session 7</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/EmSmaW-ud6A/default.jpg" title="Lecture 14: APSP and Johnson" alt="Lecture 14: APSP and Johnson">
<p>Lecture 14: APSP and Johnson</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/quiz-2-review/index.htm">
<img src="https://img.youtube.com/vi/vCIa2h1C9UQ/default.jpg" title="Quiz 2 Review" alt="Quiz 2 Review">
<p>Quiz 2 Review</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-15-dynamic-programming-part-1-srtbot-fib-dags-bowling/index.htm">
<img src="https://img.youtube.com/vi/r4-cftqTcdI/default.jpg" title="Lecture 15: Dynamic Programming, Part 1: SRTBOT, Fib, DAGs, Bowling" alt="Lecture 15: Dynamic Programming, Part 1: SRTBOT, Fib, DAGs, Bowling">
<p>Lecture 15: Dynamic Program...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-16-dynamic-programming-part-2-lcs-lis-coins/index.htm">
<img src="https://img.youtube.com/vi/KLBCUx1is2c/default.jpg" title="Lecture 16: Dynamic Programming, Part 2: LCS, LIS, Coins" alt="Lecture 16: Dynamic Programming, Part 2: LCS, LIS, Coins">
<p>Lecture 16: Dynamic Program...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/problem-session-8/index.htm">
<img src="https://img.youtube.com/vi/l_A-ig1n8CM/default.jpg" title="Problem Session 8" alt="Problem Session 8">
<p>Problem Session 8</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-17-dynamic-programming-part-3-apsp-parens-piano/index.htm">
<img src="https://img.youtube.com/vi/TDo3r5M1LNo/default.jpg" title="Lecture 17: Dynamic Programming, Part 3: APSP, Parens, Piano" alt="Lecture 17: Dynamic Programming, Part 3: APSP, Parens, Piano">
<p>Lecture 17: Dynamic Program...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-18-dynamic-programming-part-4-rods-subset-sum-pseudopolynomial/index.htm">
<img src="https://img.youtube.com/vi/i9OAOk0CUQE/default.jpg" title="Lecture 18: Dynamic Programming, Part 4: Rods, Subset Sum, Pseudopolynomial" alt="Lecture 18: Dynamic Programming, Part 4: Rods, Subset Sum, Pseudopolynomial">
<p>Lecture 18: Dynamic Program...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-19-complexity/index.htm">
<img src="https://img.youtube.com/vi/JbafQJx1CIA/default.jpg" title="Lecture 19: Complexity" alt="Lecture 19: Complexity">
<p>Lecture 19: Complexity</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/quiz-3-review/index.htm">
<img src="https://img.youtube.com/vi/wEKFGdo4Sck/default.jpg" title="Quiz 3 Review" alt="Quiz 3 Review">
<p>Quiz 3 Review</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-20-course-review/index.htm">
<img src="https://img.youtube.com/vi/2NMtS1ecb3o/default.jpg" title="Lecture 20: Course Review" alt="Lecture 20: Course Review">
<p>Lecture 20: Course Review</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/lecture-videos/lecture-21-algorithms2014next-steps/index.htm">
<img src="https://img.youtube.com/vi/4nXw-f6NJ9s/default.jpg" title="Lecture 21: Algorithms—Next Steps" alt="Lecture 21: Algorithms—Next Steps">
<p>Lecture 21: Algorithms—Ne...</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/lecture-videos/lecture-14-apsp-and-johnson/EmSmaW-ud6A.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="0">[SQUEAKING][RUSTLING][CLICKING]</span></p>
<p> </p>
<p><span m="12510">JASON KU:</span> <span m="12640">Welcome,</span> <span m="13030">everybody,</span> <span m="13440">to</span> <span m="14220">our</span> <span m="14910">lecture</span> <span m="15520">14</span> <span m="16140">of</span> <span m="16300">6.006.</span> <span m="17280">This</span> <span m="17460">is</span> <span m="17550">our</span> <span m="17700">last</span> <span m="18180">lecture</span> <span m="18780">on</span> <span m="19710">graph</span> <span m="20160">algorithms,</span> <span m="21240">in</span> <span m="21480">particular,</span> <span m="22440">the</span> <span m="22620">last</span> <span m="23610">lecture</span> <span m="24130">we'll</span> <span m="24270">have</span> <span m="24570">on</span> <span m="24840">weighted</span> <span m="25860">shortest</span> <span m="26370">paths.</span> <span m="28350">But</span> <span m="28590">we're</span> <span m="28740">going</span> <span m="28890">to</span> <span m="28980">talk</span> <span m="29220">about</span> <span m="29460">a</span> <span m="29520">slightly</span> <span m="29970">different</span> <span m="30270">problem</span> <span m="31290">today,</span> <span m="33180">different</span> <span m="33720">than</span> <span m="34530">single</span> <span m="34980">source</span> <span m="35250">shortest</span> <span m="35610">paths.</span> <span m="35970">We're</span> <span m="36060">going</span> <span m="36180">to</span> <span m="36240">be</span> <span m="36300">talking</span> <span m="36630">about</span> <span m="37350">all-pairs</span> <span m="37900">shortest</span> <span m="38310">paths.</span></p>
<p><span m="39960">But</span> <span m="40170">first,</span> <span m="40800">let's</span> <span m="41100">review</span> <span m="42390">our</span> <span m="42690">single</span> <span m="43080">source</span> <span m="43380">shortest</span> <span m="43740">paths</span> <span m="44130">algorithms.</span> <span m="45330">We</span> <span m="45600">had</span> <span m="46410">BFS,</span> <span m="47460">DAG</span> <span m="47790">relaxation,</span> <span m="48990">Dijkstra,</span> <span m="49740">which</span> <span m="49920">we</span> <span m="50010">saw</span> <span m="50220">last</span> <span m="50520">time,</span> <span m="50980">which</span> <span m="51600">gets</span> <span m="52170">pretty</span> <span m="52590">close</span> <span m="52980">to</span> <span m="53100">linear.</span> <span m="54570">V</span> <span m="54870">log</span> <span m="55290">V</span> <span m="56970">plus</span> <span m="57390">E</span> <span m="57600">is</span> <span m="57750">pretty</span> <span m="58050">close</span> <span m="58440">to</span> <span m="58530">linear.</span> <span m="59190">It's</span> <span m="59460">much</span> <span m="59670">closer</span> <span m="60090">to</span> <span m="60240">linear</span> <span m="60780">than</span> <span m="61020">the</span> <span m="61110">general</span> <span m="61500">algorithm</span> <span m="62970">we</span> <span m="63120">have</span> <span m="63390">for</span> <span m="63660">solving</span> <span m="64019">single</span> <span m="64290">source</span> <span m="64530">shortest</span> <span m="64860">paths,</span> <span m="65880">namely,</span> <span m="66300">Bellman-Ford,</span> <span m="67110">which</span> <span m="67350">is</span> <span m="67710">a</span> <span m="67890">little</span> <span m="68040">bit</span> <span m="68190">more</span> <span m="68370">like</span> <span m="68520">quadratic.</span></p>
<p><span m="69180">This</span> <span m="69390">is</span> <span m="69510">like</span> <span m="69750">the</span> <span m="69840">difference</span> <span m="70230">between--</span> <span m="71190">for</span> <span m="71460">sparse</span> <span m="71925">graphs,</span> <span m="72390">this</span> <span m="72570">is</span> <span m="72690">like</span> <span m="72870">the</span> <span m="72960">difference</span> <span m="73320">between</span> <span m="74130">sorting,</span> <span m="75870">using</span> <span m="76440">insertion</span> <span m="76960">sort</span> <span m="77255">and</span> <span m="77550">n</span> <span m="77820">squared,</span> <span m="79050">and</span> <span m="79710">merge</span> <span m="80040">sort</span> <span m="80430">in</span> <span m="80730">N</span> <span m="80940">log</span> <span m="81240">N,</span> <span m="81450">for</span> <span m="81720">example.</span> <span m="82410">We're</span> <span m="82530">going</span> <span m="82650">to</span> <span m="82710">get</span> <span m="83160">actually</span> <span m="83610">quite</span> <span m="83850">a</span> <span m="83910">big</span> <span m="84120">bonus</span> <span m="84630">for</span> <span m="85470">large</span> <span m="85980">input</span> <span m="86400">sizes</span> <span m="87000">by</span> <span m="87210">using</span> <span m="87510">Dijkstra</span> <span m="88020">when</span> <span m="88200">we</span> <span m="88290">can.</span></p>
<p><span m="89970">Today,</span> <span m="91050">we're</span> <span m="91230">going</span> <span m="91380">to</span> <span m="91440">be</span> <span m="91560">focusing</span> <span m="92100">on</span> <span m="92220">this</span> <span m="92400">new</span> <span m="92550">problem</span> <span m="93060">called</span> <span m="93330">all-pairs</span> <span m="93900">shortest</span> <span m="94260">paths.</span> <span m="95040">It's</span> <span m="95400">not</span> <span m="95670">really</span> <span m="96270">complicated.</span> <span m="97410">Instead</span> <span m="97830">of</span> <span m="97920">having</span> <span m="98160">a</span> <span m="98220">single</span> <span m="98580">source,</span> <span m="99720">we</span> <span m="99960">are</span> <span m="100080">essentially</span> <span m="100620">wanting</span> <span m="100950">to,</span> <span m="101340">given</span> <span m="101850">an</span> <span m="102030">input--</span> <span m="105192">this</span> <span m="105630">is</span> <span m="105840">our</span> <span m="105990">weighted</span> <span m="106350">graph,</span> <span m="113270">where</span> <span m="113630">we've</span> <span m="113840">got</span> <span m="114080">a</span> <span m="114500">graph</span> <span m="115910">V,</span> <span m="116170">E,</span> <span m="117890">and</span> <span m="118130">we've</span> <span m="118310">got</span> <span m="118580">a</span> <span m="118700">weight</span> <span m="119030">function</span> <span m="120380">from</span> <span m="120740">the</span> <span m="120920">edges</span> <span m="122390">to</span> <span m="122780">the</span> <span m="123350">integers.</span></p>
<p><span m="126810">This is</span> <span m="127050">our</span> <span m="127170">general</span> <span m="127650">weighted</span> <span m="127950">graph.</span> <span m="128620">We</span> <span m="128820">want</span> <span m="129000">our</span> <span m="129120">output</span> <span m="129630">to</span> <span m="129840">be</span> <span m="130050">something</span> <span m="130560">like,</span> <span m="133650">the</span> <span m="133800">shortest</span> <span m="134280">path</span> <span m="134640">distance</span> <span m="135840">from</span> <span m="136170">u</span> <span m="136470">to</span> <span m="136680">v</span> <span m="138550">for</span> <span m="138880">every</span> <span m="140440">u</span> <span m="141040">and</span> <span m="141550">v</span> <span m="142900">in</span> <span m="143170">our</span> <span m="143290">vortex</span> <span m="143770">set.</span> <span m="146130">That's</span> <span m="146410">what</span> <span m="146530">we</span> <span m="146650">want</span> <span m="146800">to</span> <span m="146860">return.</span></p>
<p><span m="147790">Now,</span> <span m="150600">there's</span> <span m="150930">one</span> <span m="151170">caveat</span> <span m="151770">here</span> <span m="152130">that,</span> <span m="152310">if</span> <span m="153780">there's</span> <span m="154050">a</span> <span m="154110">negative</span> <span m="154500">weight</span> <span m="154680">cycle</span> <span m="155130">in</span> <span m="155220">our</span> <span m="155340">graph--</span> <span m="156190">in</span> <span m="156330">other</span> <span m="156510">words,</span> <span m="156910">if</span> <span m="157440">any</span> <span m="158010">of</span> <span m="158220">these</span> <span m="159180">delta</span> <span m="159840">u,</span> <span m="160210">v's</span> <span m="162140">is</span> <span m="162380">minus</span> <span m="162800">infinity,</span> <span m="163700">there's</span> <span m="164030">a</span> <span m="164180">negative</span> <span m="164630">rate</span> <span m="164840">cycle</span> <span m="165230">in</span> <span m="165320">our</span> <span m="165470">graph.</span> <span m="167810">So</span> <span m="169070">unless,</span> <span m="170870">I</span> <span m="171050">guess--</span> <span m="173240">or</span> <span m="173555">abort</span> <span m="177050">if</span> <span m="179260">G</span> <span m="180400">contains</span> <span m="184760">a</span> <span m="185000">negative</span> <span m="186620">weight</span> <span m="189230">cycle.</span> <span m="192140">So</span> <span m="193250">we're</span> <span m="193490">not</span> <span m="193730">actually</span> <span m="194120">going</span> <span m="194270">to</span> <span m="194360">worry</span> <span m="194720">about</span> <span m="195050">negative</span> <span m="195470">weight</span> <span m="195650">cycles</span> <span m="196700">in</span> <span m="197000">today's</span> <span m="197450">class.</span></p>
<p><span m="199280">If</span> <span m="199640">we</span> <span m="199760">have</span> <span m="199910">a</span> <span m="199970">graph,</span> <span m="200300">it</span> <span m="200360">could</span> <span m="200540">have</span> <span m="200690">negative</span> <span m="201080">weights.</span> <span m="201820">These</span> <span m="202040">are</span> <span m="202340">any</span> <span m="203030">integers.</span> <span m="203960">It</span> <span m="204230">could</span> <span m="204500">include</span> <span m="204770">negative</span> <span m="205340">weight</span> <span m="205700">edges.</span> <span m="208460">But</span> <span m="208670">as</span> <span m="208790">long</span> <span m="209090">as</span> <span m="209420">all</span> <span m="209750">of</span> <span m="209930">our</span> <span m="210800">path</span> <span m="211310">distances</span> <span m="212270">are</span> <span m="214400">bounded</span> <span m="215240">from</span> <span m="215690">below,</span> <span m="218320">none</span> <span m="218620">of</span> <span m="218710">them</span> <span m="218920">are</span> <span m="219160">negative</span> <span m="219700">infinity,</span> <span m="220540">we</span> <span m="220780">don't</span> <span m="220990">have</span> <span m="221170">any</span> <span m="221350">negative</span> <span m="221680">weight</span> <span m="221830">cycles,</span> <span m="222770">then</span> <span m="223120">I</span> <span m="223240">want</span> <span m="223420">you</span> <span m="223540">to</span> <span m="223660">output</span> <span m="224560">all</span> <span m="224860">of</span> <span m="224950">these</span> <span m="225100">shortest</span> <span m="225430">path</span> <span m="225700">distances.</span></p>
<p><span m="226330">Now,</span> <span m="226840">in</span> <span m="227080">particular,</span> <span m="227740">this</span> <span m="227920">output</span> <span m="228490">could--</span> <span m="229580">any</span> <span m="229990">of</span> <span m="230110">these</span> <span m="230320">outputs</span> <span m="231100">needs</span> <span m="231400">to</span> <span m="231550">have</span> <span m="231760">size</span> <span m="232780">theta</span> <span m="233950">of</span> <span m="234320">V</span> <span m="234460">squared.</span> <span m="236800">Because</span> <span m="237190">for</span> <span m="237490">every</span> <span m="237970">pair</span> <span m="238240">of</span> <span m="238330">vertices,</span> <span m="238870">I</span> <span m="238960">need</span> <span m="239110">to</span> <span m="239200">return</span> <span m="239620">to</span> <span m="239760">you</span> <span m="239860">a</span> <span m="239920">number,</span> <span m="240940">or</span> <span m="241450">infinity,</span> <span m="242230">or</span> <span m="242620">minus</span> <span m="242980">infinity</span> <span m="243430">or</span> <span m="243520">something</span> <span m="243820">like</span> <span m="243970">that.</span> <span m="244400">But</span> <span m="244510">we</span> <span m="244630">are</span> <span m="244720">not</span> <span m="244930">dealing</span> <span m="245290">with</span> <span m="245420">a</span> <span m="245470">case</span> <span m="245770">with</span> <span m="245890">minus</span> <span m="246250">infinity.</span> <span m="247210">The</span> <span m="247540">output</span> <span m="248710">could</span> <span m="249070">have</span> <span m="249310">size--</span> <span m="251320">this</span> <span m="251560">is</span> <span m="251650">a</span> <span m="251710">theta</span> <span m="252100">here.</span> <span m="252460">It</span> <span m="252610">does</span> <span m="252940">have</span> <span m="253180">size</span> <span m="253720">V</span> <span m="253930">squared.</span></p>
<p><span m="256750">But</span> <span m="256930">in</span> <span m="257050">particular,</span> <span m="257800">it's</span> <span m="258070">at</span> <span m="258190">least</span> <span m="258649">V</span> <span m="258850">squared</span> <span m="260860">because</span> <span m="261160">I</span> <span m="261250">need</span> <span m="261430">to</span> <span m="261519">give</span> <span m="263330">a</span> <span m="263620">number</span> <span m="264010">for</span> <span m="264310">each</span> <span m="264550">pair</span> <span m="264760">of</span> <span m="264850">vertices.</span> <span m="265960">And</span> <span m="266230">so</span> <span m="266530">we</span> <span m="266680">couldn't</span> <span m="267130">hope</span> <span m="267460">for</span> <span m="267700">linear</span> <span m="268030">time</span> <span m="270260">in</span> <span m="270470">the</span> <span m="270530">size</span> <span m="270830">of</span> <span m="270890">this</span> <span m="271070">graph</span> <span m="271580">for</span> <span m="271880">this</span> <span m="272090">problem,</span> <span m="272660">right?</span> <span m="273530">Single</span> <span m="273860">source</span> <span m="274145">shortest</span> <span m="274430">paths,</span> <span m="274820">for</span> <span m="275090">certain</span> <span m="275630">versions</span> <span m="276050">of</span> <span m="276170">the</span> <span m="276230">problem,</span> <span m="277100">we</span> <span m="277250">need</span> <span m="277430">to</span> <span m="277490">read</span> <span m="277820">the</span> <span m="277910">graph.</span> <span m="278550">And</span> <span m="278650">so</span> <span m="278720">we</span> <span m="278840">need</span> <span m="278990">to</span> <span m="279200">use</span> <span m="279890">linear</span> <span m="280340">time.</span></p>
<p><span m="281580">But</span> <span m="281690">in</span> <span m="281780">this</span> <span m="281930">problem,</span> <span m="282350">our</span> <span m="282500">output</span> <span m="283070">has</span> <span m="283340">quadratic</span> <span m="283950">size</span> <span m="284240">in</span> <span m="284330">the</span> <span m="284420">number</span> <span m="284660">of</span> <span m="284720">vertices.</span> <span m="285990">So</span> <span m="286160">in</span> <span m="286280">a</span> <span m="286340">sense,</span> <span m="286940">we</span> <span m="287090">can't</span> <span m="287390">do</span> <span m="287600">better</span> <span m="287960">than</span> <span m="288200">this.</span> <span m="289620">We</span> <span m="289790">can't</span> <span m="290000">do</span> <span m="290120">better</span> <span m="290450">than</span> <span m="290630">quadratic.</span> <span m="292040">And</span> <span m="292400">actually,</span> <span m="294810">what's</span> <span m="295140">one</span> <span m="295410">way</span> <span m="295680">we</span> <span m="295830">could</span> <span m="296010">solve</span> <span m="296550">all-pairs</span> <span m="297000">shortest</span> <span m="297420">paths</span> <span m="298290">by</span> <span m="298530">using</span> <span m="298890">stuff</span> <span m="299190">we've</span> <span m="299370">already</span> <span m="299610">done</span> <span m="299820">in</span> <span m="299910">this</span> <span m="300060">class?</span> <span m="302170">That's</span> <span m="302340">why</span> <span m="302460">I</span> <span m="302550">put</span> <span m="302730">this</span> <span m="302880">slide</span> <span m="303210">up</span> <span m="303390">here.</span></p>
<p><span m="304650">Yeah,</span> <span m="304950">we</span> <span m="305070">could</span> <span m="305220">just</span> <span m="305850">solve</span> <span m="306480">a</span> <span m="306600">single</span> <span m="306990">source</span> <span m="307320">shortest</span> <span m="307650">paths</span> <span m="307950">algorithm</span> <span m="309180">from</span> <span m="309780">every</span> <span m="310230">vertex</span> <span m="310740">in</span> <span m="310830">my</span> <span m="310950">graph.</span> <span m="312180">That</span> <span m="312690">seems</span> <span m="313080">like</span> <span m="313260">a</span> <span m="313320">stupid</span> <span m="313710">thing</span> <span m="313890">to</span> <span m="313980">do.</span> <span m="315060">It's</span> <span m="315210">almost</span> <span m="315630">brute</span> <span m="315900">force</span> <span m="316290">on</span> <span m="316440">the</span> <span m="316500">vertices.</span> <span m="317670">But</span> <span m="317910">it's</span> <span m="318030">certainly</span> <span m="318420">a</span> <span m="318480">way</span> <span m="318690">we</span> <span m="318810">could</span> <span m="318930">solve</span> <span m="319200">this</span> <span m="319350">problem,</span> <span m="319980">in</span> <span m="320370">polynomial</span> <span m="321000">time.</span></p>
<p><span m="323450">And</span> <span m="323810">we</span> <span m="323960">could</span> <span m="324110">definitely</span> <span m="324740">solve</span> <span m="325130">it</span> <span m="327940">in</span> <span m="330720">order</span> <span m="332790">V</span> <span m="333540">squared</span> <span m="334770">E</span> <span m="335070">time,</span> <span m="337570">using</span> <span m="338020">Bellman-Ford.</span> <span m="338980">We</span> <span m="339100">just</span> <span m="339340">take</span> <span m="340120">V</span> <span m="340670">steps</span> <span m="341290">of</span> <span m="341500">Bellman-Ford</span> <span m="343440">and</span> <span m="343740">deal</span> <span m="344010">with</span> <span m="345520">a</span> <span m="345730">graph</span> <span m="346330">on</span> <span m="346840">any</span> <span m="347140">set</span> <span m="347350">of</span> <span m="347410">vertices.</span> <span m="348130">We</span> <span m="348220">can</span> <span m="348340">do</span> <span m="348430">better</span> <span m="348730">than</span> <span m="348910">this.</span> <span m="351170">We</span> <span m="351250">can</span> <span m="351400">do</span> <span m="351550">better</span> <span m="351880">than</span> <span m="352090">this</span> <span m="352570">for</span> <span m="352990">graphs</span> <span m="354310">that</span> <span m="354610">are</span> <span m="354760">special</span> <span m="355240">in</span> <span m="355330">some</span> <span m="355600">way.</span> <span m="356380">We</span> <span m="356590">can</span> <span m="356800">do</span> <span m="358330">V</span> <span m="358780">times</span> <span m="359470">V</span> <span m="359680">plus</span> <span m="359965">E,</span> <span m="360250">V</span> <span m="360430">times</span> <span m="360910">linear.</span></p>
<p><span m="362140">If</span> <span m="362500">our</span> <span m="363100">weights</span> <span m="363670">are</span> <span m="363760">positive</span> <span m="364015">and</span> <span m="364270">bounded,</span> <span m="365020">we</span> <span m="365170">can</span> <span m="365320">use</span> <span m="365500">BFS</span> <span m="366160">V</span> <span m="366400">times.</span> <span m="367090">Or</span> <span m="367330">if</span> <span m="367450">our</span> <span m="367570">graph</span> <span m="368110">doesn't</span> <span m="368350">have</span> <span m="368470">cycles,</span> <span m="368920">we</span> <span m="369040">could</span> <span m="369190">use</span> <span m="369370">DAG</span> <span m="369670">relaxation</span> <span m="370390">V</span> <span m="370540">times.</span> <span m="371320">Or</span> <span m="371560">if</span> <span m="371710">our</span> <span m="371830">graph</span> <span m="372160">had</span> <span m="372400">non-negative</span> <span m="372700">edge</span> <span m="373000">weights,</span> <span m="373420">we</span> <span m="373510">could</span> <span m="373660">get,</span> <span m="375470">basically,</span> <span m="376010">V</span> <span m="376370">squared</span> <span m="376880">log</span> <span m="377180">V</span> <span m="377480">plus</span> <span m="378140">V</span> <span m="378410">times</span> <span m="378800">E.</span> <span m="381160">And</span> <span m="381400">that's</span> <span m="381640">actually</span> <span m="381970">not</span> <span m="382180">bad.</span></p>
<p><span m="382540">In</span> <span m="382780">sparse</span> <span m="383440">graphs,</span> <span m="386560">this</span> <span m="386830">is</span> <span m="386950">what</span> <span m="387130">Bellman-Ford</span> <span m="387730">would</span> <span m="387880">give</span> <span m="388060">us.</span> <span m="396510">But</span> <span m="396750">if</span> <span m="397170">we</span> <span m="397650">had</span> <span m="398070">Dijkstra's,</span> <span m="399030">for</span> <span m="399330">example,</span> <span m="400000">if</span> <span m="400110">we</span> <span m="400230">had</span> <span m="400440">all</span> <span m="400830">positive</span> <span m="401910">edge</span> <span m="402405">weights--</span> <span m="402900">or</span> <span m="403300">non-negative,</span> <span m="404010">sorry,</span> <span m="405180">we</span> <span m="405390">could</span> <span m="405540">get</span> <span m="405810">V</span> <span m="406170">squared</span> <span m="407640">log</span> <span m="408150">V</span> <span m="409350">plus</span> <span m="410790">V,</span> <span m="412620">E</span> <span m="414660">time.</span> <span m="415830">This</span> <span m="416130">is</span> <span m="417180">V</span> <span m="418140">times</span> <span m="420390">Dijkstra.</span></p>
<p><span m="428330">OK,</span> <span m="429080">so</span> <span m="429410">how</span> <span m="429620">do</span> <span m="429740">these</span> <span m="430010">running</span> <span m="430340">times</span> <span m="430580">compare?</span> <span m="430910">This</span> <span m="431090">is</span> <span m="431210">V</span> <span m="431360">times</span> <span m="431660">Bellman-Ford.</span> <span m="432200">This</span> <span m="432470">is V</span> <span m="432740">times</span> <span m="433010">Dijkstra.</span> <span m="435140">Let's</span> <span m="435770">just</span> <span m="436640">get</span> <span m="436910">a</span> <span m="436970">feel</span> <span m="437390">for</span> <span m="437570">this</span> <span m="438080">separation</span> <span m="438920">here.</span> <span m="439580">If</span> <span m="440540">we</span> <span m="440630">had</span> <span m="440720">a</span> <span m="440780">sparse</span> <span m="441200">graph</span> <span m="441560">where</span> <span m="441770">V</span> <span m="442070">is</span> <span m="442840">upper-bounded</span> <span m="443600">by</span> <span m="443750">the</span> <span m="443840">number</span> <span m="444080">of</span> <span m="444140">vertices,</span> <span m="445220">this</span> <span m="445550">one</span> <span m="445760">looks</span> <span m="446060">like</span> <span m="446840">V</span> <span m="447110">squared</span> <span m="447530">log</span> <span m="447770">V.</span></p>
<p><span m="449310">This</span> <span m="449670">one</span> <span m="449940">looks</span> <span m="450240">like</span> <span m="451310">V</span> <span m="451790">cubed.</span> <span m="453900">And</span> <span m="454140">we</span> <span m="454260">need</span> <span m="454410">to</span> <span m="454860">spend</span> <span m="455130">at</span> <span m="455250">least</span> <span m="455850">V</span> <span m="456060">squared</span> <span m="456540">time.</span> <span m="458670">So</span> <span m="459000">actually,</span> <span m="459450">this</span> <span m="459780">is</span> <span m="459900">really</span> <span m="460230">close</span> <span m="460980">to</span> <span m="461220">linear</span> <span m="461580">in</span> <span m="461670">the</span> <span m="461730">size</span> <span m="462000">of</span> <span m="462090">the</span> <span m="462180">graph,</span> <span m="463080">just</span> <span m="463350">off</span> <span m="463530">by</span> <span m="463680">a</span> <span m="463740">log</span> <span m="464010">factor,</span> <span m="464640">just</span> <span m="464910">like</span> <span m="465120">sorting</span> <span m="465540">would</span> <span m="465960">entail.</span> <span m="467620">And</span> <span m="467860">this</span> <span m="468190">one</span> <span m="471430">would</span> <span m="472120">have</span> <span m="472540">a</span> <span m="472720">linear</span> <span m="473140">factor.</span> <span m="474670">In</span> <span m="474940">the</span> <span m="475030">sparse</span> <span m="475780">graph,</span> <span m="475880">this</span> <span m="475990">would</span> <span m="476110">be</span> <span m="476280">a</span> <span m="476740">linear</span> <span m="477160">factor</span> <span m="477610">worse</span> <span m="477910">than</span> <span m="478090">this,</span> <span m="478360">instead</span> <span m="478630">of</span> <span m="478750">a</span> <span m="478780">logarithmic</span> <span m="479380">factor--</span> <span m="480100">again,</span> <span m="480550">this</span> <span m="481120">linear</span> <span m="481570">to</span> <span m="481720">log</span> <span m="482020">separation.</span></p>
<p><span m="483070">We</span> <span m="483340">don't</span> <span m="483520">want</span> <span m="483730">to</span> <span m="483820">have</span> <span m="484060">to</span> <span m="484180">do</span> <span m="485110">this</span> <span m="485440">running</span> <span m="485770">time</span> <span m="486100">if</span> <span m="486220">we</span> <span m="486310">don't</span> <span m="486520">have</span> <span m="486760">to.</span> <span m="489250">That's</span> <span m="489550">the</span> <span m="489910">name</span> <span m="490210">of</span> <span m="490270">the</span> <span m="490360">game.</span> <span m="490640">And</span> <span m="492290">really,</span> <span m="493790">all</span> <span m="494120">we're</span> <span m="494270">going</span> <span m="494390">to</span> <span m="494480">do</span> <span m="494750">in</span> <span m="494930">this</span> <span m="495170">lecture</span> <span m="496790">is</span> <span m="497150">try</span> <span m="497450">to</span> <span m="497960">solve</span> <span m="499280">how</span> <span m="499610">we</span> <span m="499820">can</span> <span m="500420">make</span> <span m="501380">this</span> <span m="502010">running</span> <span m="502430">time</span> <span m="502760">faster</span> <span m="504740">by</span> <span m="504980">doing</span> <span m="505280">something</span> <span m="505790">a</span> <span m="505850">little</span> <span m="506090">bit</span> <span m="506360">more</span> <span m="506660">intelligent</span> <span m="507320">than</span> <span m="508580">running</span> <span m="508970">a</span> <span m="509030">single</span> <span m="509300">source</span> <span m="509540">shortest</span> <span m="509840">path</span> <span m="510110">algorithm</span> <span m="511190">from</span> <span m="511670">every</span> <span m="511910">vertex.</span></p>
<p><span m="517419">How</span> <span m="517630">are</span> <span m="517690">we</span> <span m="517780">going</span> <span m="517900">to</span> <span m="517960">do</span> <span m="518110">that?</span> <span m="518960">Well,</span> <span m="521659">we</span> <span m="521900">could--</span> <span m="525580">let's</span> <span m="525880">see.</span> <span m="526330">What</span> <span m="526540">are</span> <span m="526600">we</span> <span m="526690">doing?</span> <span m="527860">Right.</span> <span m="528910">The</span> <span m="529090">idea</span> <span m="529510">here,</span> <span m="530240">if</span> <span m="530560">we</span> <span m="530680">had</span> <span m="530920">a</span> <span m="530980">graph--</span> <span m="537240">should</span> <span m="537480">my</span> <span m="537630">graph</span> <span m="537960">be</span> <span m="538320">directed</span> <span m="539010">or</span> <span m="539160">undirected?</span> <span m="541320">I'm</span> <span m="541800">not</span> <span m="542070">sure.</span> <span m="542550">Let's</span> <span m="542790">see</span> <span m="543120">if</span> <span m="543240">we</span> <span m="543360">can</span> <span m="543540">make</span> <span m="543870">a</span> <span m="544050">directed</span> <span m="544560">graph.</span> <span m="545180">OK,</span> <span m="545940">so</span> <span m="546120">here's</span> <span m="546360">a</span> <span m="546420">directed</span> <span m="546870">graph.</span></p>
<p><span m="548140">Why</span> <span m="548350">do</span> <span m="548470">I</span> <span m="548560">not</span> <span m="548740">care</span> <span m="548950">about</span> <span m="549220">undirected</span> <span m="549790">graphs?</span> <span m="550270">Can</span> <span m="550480">anyone</span> <span m="550720">tell</span> <span m="550870">me?</span> <span m="553450">Yeah,</span> <span m="553960">it's</span> <span m="554260">because--</span> <span m="556960">I</span> <span m="557320">don't</span> <span m="557500">care</span> <span m="557770">about</span> <span m="558130">undirected</span> <span m="558760">graphs</span> <span m="559270">because,</span> <span m="560080">if</span> <span m="560380">I</span> <span m="560500">had</span> <span m="560710">an</span> <span m="560830">undirected</span> <span m="561340">graph,</span> <span m="564710">I</span> <span m="564920">could</span> <span m="565100">detect</span> <span m="565520">whether</span> <span m="565790">I</span> <span m="565850">had</span> <span m="566030">negative</span> <span m="566390">weight</span> <span m="566570">cycles</span> <span m="568330">in</span> <span m="574550">constant</span> <span m="575390">time--</span> <span m="576470">I'm</span> <span m="576770">sorry,</span> <span m="577040">in</span> <span m="577400">linear</span> <span m="577700">time.</span> <span m="578090">I</span> <span m="578270">could</span> <span m="578390">just</span> <span m="578540">check</span> <span m="578870">each</span> <span m="579200">edge,</span> <span m="579750">see</span> <span m="580100">if</span> <span m="580250">it</span> <span m="580340">has</span> <span m="580490">negative</span> <span m="580820">weight,</span> <span m="583720">because</span> <span m="584300">a</span> <span m="584530">negative</span> <span m="584920">weight</span> <span m="585130">edge, an</span> <span m="585490">undirected</span> <span m="586090">edge</span> <span m="586630">is</span> <span m="586990">a</span> <span m="587050">cycle</span> <span m="587410">of</span> <span m="587500">negative</span> <span m="587860">weight.</span></p>
<p><span m="588880">So</span> <span m="590080">I</span> <span m="590320">could</span> <span m="590530">just--</span> <span m="590860">if</span> <span m="591040">it</span> <span m="591190">has</span> <span m="591550">any</span> <span m="591850">negative</span> <span m="592360">edge</span> <span m="592630">weights,</span> <span m="593440">I</span> <span m="593680">could</span> <span m="593860">return</span> <span m="594370">in</span> <span m="594460">linear</span> <span m="594790">time</span> <span m="596630">that</span> <span m="596870">it</span> <span m="596990">does,</span> <span m="597380">and</span> <span m="597470">I</span> <span m="597560">can</span> <span m="597710">abort.</span> <span m="598760">Or</span> <span m="599360">it</span> <span m="599600">has</span> <span m="599750">only</span> <span m="599990">positive</span> <span m="600410">weights,</span> <span m="600680">and</span> <span m="600800">I</span> <span m="600860">can</span> <span m="601010">still</span> <span m="601310">use</span> <span m="601490">Dijkstra.</span> <span m="602450">So</span> <span m="602660">that's</span> <span m="602870">all</span> <span m="603020">good.</span> <span m="603540">So</span> <span m="603740">we're</span> <span m="604220">only</span> <span m="604610">concerned</span> <span m="605180">about</span> <span m="605660">needing</span> <span m="606020">to</span> <span m="606140">run</span> <span m="606350">Bellman-Ford</span> <span m="606660">on</span> <span m="606950">directed</span> <span m="607760">graphs</span> <span m="608390">that</span> <span m="608600">potentially</span> <span m="609080">have</span> <span m="609200">negative</span> <span m="609560">edge</span> <span m="609920">weight.</span></p>
<p><span m="610520">OK,</span> <span m="610820">so</span> <span m="610970">here's</span> <span m="611210">a</span> <span m="611240">graph.</span> <span m="613410">Let's</span> <span m="613580">see.</span> <span m="614540">Is</span> <span m="614750">this</span> <span m="614930">a</span> <span m="614990">graph</span> <span m="615260">that</span> <span m="615440">I</span> <span m="615530">want?</span> <span m="618920">Sure.</span> <span m="620920">Let's</span> <span m="621310">say</span> <span m="621640">we've</span> <span m="621910">got</span> <span m="628330">that</span> <span m="628690">direction</span> <span m="629540">and</span> <span m="629950">this</span> <span m="630250">direction.</span> <span m="633530">Say</span> <span m="633860">we</span> <span m="634070">have</span> <span m="634520">a</span> <span m="634850">directed</span> <span m="635570">graph</span> <span m="636050">like</span> <span m="636290">this.</span> <span m="636780">And</span> <span m="636880">let's</span> <span m="636950">say</span> <span m="637130">this</span> <span m="637340">is</span> <span m="637530">s.</span> <span m="638390">This</span> <span m="638630">is</span> <span m="638750">our</span> <span m="638900">source.</span> <span m="641610">And</span> <span m="643260">we</span> <span m="643530">have</span> <span m="644130">weights</span> <span m="645360">being</span> <span m="647220">2--</span> <span m="649120">sorry,</span> <span m="649540">weights</span> <span m="649870">being</span> <span m="651190">4,</span> <span m="652420">1,</span> <span m="653260">1,</span> <span m="654100">2,</span> <span m="655000">2,</span> <span m="655900">2,</span> <span m="656350">2.</span></p>
<p><span m="658450">So</span> <span m="658660">this</span> <span m="658840">is</span> <span m="658990">an</span> <span m="659110">example</span> <span m="659740">of</span> <span m="660070">a</span> <span m="660400">graph</span> <span m="660880">we</span> <span m="661030">might</span> <span m="661240">want</span> <span m="661450">to</span> <span m="661960">run</span> <span m="664280">all-pairs</span> <span m="664770">shortest</span> <span m="665090">paths</span> <span m="665450">on.</span> <span m="665840">Maybe</span> <span m="666230">we</span> <span m="666350">also</span> <span m="666590">have</span> <span m="666740">negative</span> <span m="667100">weights</span> <span m="667400">in</span> <span m="667520">this</span> <span m="667670">graph.</span> <span m="673660">In</span> <span m="673840">particular,</span> <span m="674410">this</span> <span m="674560">has</span> <span m="674740">a</span> <span m="674770">negative</span> <span m="675100">weight</span> <span m="675250">cycle.</span> <span m="676090">I</span> <span m="676300">don't</span> <span m="676420">want</span> <span m="676630">negative</span> <span m="676960">weight</span> <span m="677140">cycles,</span> <span m="677650">so</span> <span m="677770">I'm</span> <span m="677860">going</span> <span m="677980">to</span> <span m="678070">make</span> <span m="678340">this</span> <span m="679750">0.</span> <span m="682310">So</span> <span m="682640">this</span> <span m="682850">graph</span> <span m="683210">doesn't</span> <span m="683540">have</span> <span m="683690">negative</span> <span m="683990">weight</span> <span m="684140">cycles.</span> <span m="684680">Great.</span> <span m="687740">That's</span> <span m="688160">true,</span> <span m="688490">great.</span></p>
<p><span m="690210">All</span> <span m="690360">right,</span> <span m="690570">so</span> <span m="690720">here's</span> <span m="690930">an</span> <span m="691020">example</span> <span m="691500">that</span> <span m="691680">we</span> <span m="691830">might</span> <span m="692610">want</span> <span m="692940">to</span> <span m="693150">compute</span> <span m="693510">shortest</span> <span m="693840">paths</span> <span m="694200">on.</span> <span m="695070">There's</span> <span m="695340">no</span> <span m="695550">s</span> <span m="695910">in</span> <span m="696210">all-pairs</span> <span m="696690">shortest</span> <span m="697050">paths.</span> <span m="697770">But</span> <span m="698100">I'm</span> <span m="698250">going</span> <span m="698370">to</span> <span m="698430">be</span> <span m="698550">talking</span> <span m="699030">about</span> <span m="700110">a</span> <span m="700320">couple</span> <span m="700610">of</span> <span m="700650">shortest</span> <span m="700980">paths</span> <span m="701250">from</span> <span m="701430">s</span> <span m="701820">in</span> <span m="702000">my</span> <span m="702120">next</span> <span m="702420">argument,</span> <span m="703240">so</span> <span m="703350">I'm</span> <span m="703470">just</span> <span m="703650">labeling</span> <span m="704190">that</span> <span m="705030">vertex</span> <span m="705600">as</span> <span m="705810">s.</span></p>
<p><span m="706680">OK,</span> <span m="707160">the</span> <span m="707310">claim--</span> <span m="708420">the</span> <span m="708900">approach</span> <span m="709290">we're</span> <span m="709410">going</span> <span m="709530">to</span> <span m="709620">do,</span> <span m="710190">we're</span> <span m="710340">going</span> <span m="710460">to</span> <span m="710550">try</span> <span m="710760">to</span> <span m="710880">take</span> <span m="711210">a</span> <span m="711270">graph</span> <span m="711990">that</span> <span m="712320">has</span> <span m="712770">negative</span> <span m="713250">edge</span> <span m="713460">weights,</span> <span m="715250">directed</span> <span m="715730">graph.</span> <span m="717620">We</span> <span m="717800">don't</span> <span m="717950">know</span> <span m="718100">if</span> <span m="718250">it</span> <span m="718400">has</span> <span m="718790">negative</span> <span m="719210">cycles</span> <span m="719600">or</span> <span m="719690">not</span> <span m="719960">yet.</span> <span m="721160">But</span> <span m="721370">we</span> <span m="721490">want</span> <span m="721670">to</span> <span m="721730">compute</span> <span m="722240">all-pairs</span> <span m="722600">shortest</span> <span m="722930">paths,</span> <span m="723770">not</span> <span m="724130">in</span> <span m="724280">this</span> <span m="724490">running</span> <span m="724760">time,</span> <span m="725190">but</span> <span m="725240">in</span> <span m="725330">this</span> <span m="725510">running</span> <span m="725780">time.</span></p>
<p><span m="727510">How</span> <span m="727720">could</span> <span m="727870">we</span> <span m="727990">do</span> <span m="728140">that?</span> <span m="728930">Well,</span> <span m="730030">maybe</span> <span m="730510">it's</span> <span m="730690">possible</span> <span m="731260">that</span> <span m="731440">we</span> <span m="731560">can</span> <span m="732550">change</span> <span m="733120">the</span> <span m="733270">weight</span> <span m="733660">of</span> <span m="733870">every</span> <span m="734230">edge</span> <span m="736380">so</span> <span m="736680">that</span> <span m="736860">they're</span> <span m="737040">all</span> <span m="737190">positive,</span> <span m="738370">but</span> <span m="738510">shortest</span> <span m="738990">paths</span> <span m="739500">are</span> <span m="739590">preserved.</span> <span m="740210">So</span> <span m="740310">basically,</span> <span m="741360">if</span> <span m="742650">a</span> <span m="742830">particular</span> <span m="743430">path--</span> <span m="744060">like</span> <span m="744840">OK,</span> <span m="745140">the</span> <span m="745260">shortest</span> <span m="745590">path</span> <span m="745860">from</span> <span m="746100">s</span> <span m="746430">to</span> <span m="746580">t</span> <span m="746850">here</span> <span m="747930">is</span> <span m="748740">1,</span> <span m="749430">2,</span> <span m="750180">3.</span></p>
<p><span m="752970">I</span> <span m="753210">could</span> <span m="753420">change</span> <span m="753900">edge</span> <span m="754380">weights</span> <span m="755550">in</span> <span m="755820">this</span> <span m="756060">graph.</span> <span m="757780">Say,</span> <span m="758180">for</span> <span m="758260">example,</span> <span m="758750">if</span> <span m="758770">I</span> <span m="758860">changed</span> <span m="759220">1</span> <span m="759610">to</span> <span m="760000">0</span> <span m="760450">here,</span> <span m="761920">that</span> <span m="762160">would</span> <span m="762310">still</span> <span m="762700">make</span> <span m="763300">this</span> <span m="763990">a</span> <span m="764110">shortest</span> <span m="764500">path.</span> <span m="766680">I</span> <span m="766860">haven't</span> <span m="767070">done--</span> <span m="767340">I've</span> <span m="767580">reweighted</span> <span m="768180">the</span> <span m="768240">graph.</span> <span m="768960">Shortest</span> <span m="769530">paths</span> <span m="769980">have</span> <span m="770160">to</span> <span m="770250">be</span> <span m="770370">the</span> <span m="770460">same</span> <span m="770790">in</span> <span m="770880">this</span> <span m="771060">graph.</span></p>
<p><span m="774660">But</span> <span m="774900">now--</span> <span m="778610">sorry.</span> <span m="779510">Yeah,</span> <span m="782340">this</span> <span m="782550">is</span> <span m="782700">not</span> <span m="782880">a</span> <span m="782910">shortest</span> <span m="783240">path.</span> <span m="785910">OK,</span> <span m="786130">I'll</span> <span m="786240">make</span> <span m="786420">that</span> <span m="786840">minus</span> <span m="787350">2,</span> <span m="789840">and</span> <span m="790080">then</span> <span m="790260">these</span> <span m="790470">both</span> <span m="790860">2,</span> <span m="791640">and</span> <span m="792120">I</span> <span m="792360">think</span> <span m="794530">this</span> <span m="795340">4.</span> <span m="796300">Man,</span> <span m="796690">I</span> <span m="796780">really</span> <span m="797020">should</span> <span m="797170">have</span> <span m="797890">done</span> <span m="798160">my</span> <span m="799150">example</span> <span m="799660">beforehand.</span></p>
<p><span m="800320">OK,</span> <span m="801070">so</span> <span m="801250">this</span> <span m="801400">still</span> <span m="801670">doesn't</span> <span m="801970">have</span> <span m="802120">negative</span> <span m="802420">weight</span> <span m="802600">cycles.</span> <span m="803050">It</span> <span m="803140">has</span> <span m="803320">a</span> <span m="803380">negative</span> <span m="803640">weight</span> <span m="803900">edge.</span> <span m="804760">But</span> <span m="804970">this</span> <span m="805240">path</span> <span m="805570">is</span> <span m="805690">longer</span> <span m="805990">than</span> <span m="806140">this</span> <span m="806350">path.</span> <span m="807170">So</span> <span m="807340">when</span> <span m="807520">this</span> <span m="807730">was</span> <span m="807940">1,</span> <span m="809020">this</span> <span m="809530">had</span> <span m="810010">length</span> <span m="810460">of</span> <span m="810790">3,</span> <span m="811570">which</span> <span m="811960">was</span> <span m="812410">shorter</span> <span m="813190">than</span> <span m="813610">this</span> <span m="813940">path.</span> <span m="816960">That</span> <span m="817920">is</span> <span m="818130">length</span> <span m="818400">4.</span> <span m="820150">OK,</span> <span m="821180">cool.</span> <span m="822160">So</span> <span m="822400">this</span> <span m="823240">is</span> <span m="823750">the</span> <span m="823900">shortest</span> <span m="824260">path</span> <span m="824560">from</span> <span m="824650">s to</span> <span m="825040">t.</span></p>
<p><span m="826300">I</span> <span m="826540">could</span> <span m="826690">change</span> <span m="827350">weights</span> <span m="827950">in</span> <span m="828160">this</span> <span m="828340">graph,</span> <span m="828730">for</span> <span m="829120">example,</span> <span m="830210">changing</span> <span m="831370">2</span> <span m="831880">to</span> <span m="832270">3</span> <span m="833200">and</span> <span m="833710">1</span> <span m="834130">to</span> <span m="834340">0.</span> <span m="835360">That</span> <span m="835690">changed</span> <span m="836350">weights</span> <span m="836680">in</span> <span m="836770">my</span> <span m="836920">graph,</span> <span m="837820">but</span> <span m="838030">shortest</span> <span m="838390">paths</span> <span m="838780">remain</span> <span m="839080">the</span> <span m="839140">same.</span> <span m="841320">So</span> <span m="841460">maybe</span> <span m="841850">there's</span> <span m="842060">a</span> <span m="842150">way</span> <span m="842540">I</span> <span m="842690">could</span> <span m="842870">reweight</span> <span m="843320">my</span> <span m="843530">edges</span> <span m="844280">so</span> <span m="844520">that</span> <span m="844700">shortest</span> <span m="845150">paths</span> <span m="845510">stay</span> <span m="845780">the</span> <span m="845870">same,</span> <span m="846110">shortest</span> <span m="846410">paths</span> <span m="846680">are</span> <span m="846770">preserved.</span> <span m="851620">So</span> <span m="851830">I'm</span> <span m="851920">going</span> <span m="852040">to</span> <span m="852190">put</span> <span m="852430">this</span> <span m="852640">back</span> <span m="852910">to</span> <span m="853000">where</span> <span m="853210">it</span> <span m="853270">was.</span></p>
<p><span m="855880">So</span> <span m="856150">idea--</span> <span m="861190">make</span> <span m="863830">edge</span> <span m="865840">weights</span> <span m="869870">non-negative</span> <span m="872980">while</span> <span m="875080">preserving</span> <span m="879940">shortest</span> <span m="880510">paths.</span> <span m="883810">In</span> <span m="884050">other</span> <span m="884200">words,</span> <span m="884510">just</span> <span m="884680">reweight</span> <span m="885700">the</span> <span m="885940">edges</span> <span m="886270">here</span> <span m="886880">so</span> <span m="887020">that</span> <span m="888220">shortest</span> <span m="888670">paths</span> <span m="889060">in</span> <span m="889300">G--</span> <span m="890680">this</span> <span m="890960">is</span> <span m="891070">G--</span> <span m="892330">after</span> <span m="892810">we</span> <span m="893170">reweight</span> <span m="893590">will</span> <span m="893800">go</span> <span m="894010">to</span> <span m="894190">some</span> <span m="895450">graph</span> <span m="895930">G</span> <span m="896170">prime,</span> <span m="896650">with</span> <span m="897070">the</span> <span m="897220">same</span> <span m="897700">combinatorial</span> <span m="898510">structure</span> <span m="899170">just</span> <span m="899470">different</span> <span m="899770">edge</span> <span m="899950">weights.</span> <span m="900610">And</span> <span m="900820">we</span> <span m="900940">want</span> <span m="901450">shortest</span> <span m="902110">paths--</span> <span m="903040">we</span> <span m="903250">want</span> <span m="903460">these</span> <span m="903730">weights</span> <span m="904090">to</span> <span m="904210">all</span> <span m="904360">be</span> <span m="904720">non-negative.</span> <span m="905830">And</span> <span m="906040">we</span> <span m="906130">want</span> <span m="906310">shortest</span> <span m="906850">paths,</span> <span m="907360">if</span> <span m="907510">there's</span> <span m="907720">a</span> <span m="907780">shortest</span> <span m="908170">path</span> <span m="908500">in</span> <span m="908590">G,</span> <span m="909130">it</span> <span m="909430">continues</span> <span m="910030">to</span> <span m="910120">be</span> <span m="910270">a</span> <span m="910330">shortest</span> <span m="910750">path</span> <span m="911020">in</span> <span m="911110">the</span> <span m="911200">reweighted</span> <span m="911650">graph.</span></p>
<p><span m="912190">That's</span> <span m="912550">the</span> <span m="912640">goal</span> <span m="912880">for</span> <span m="913060">today.</span> <span m="916560">If</span> <span m="917880">we</span> <span m="918120">can</span> <span m="918300">do</span> <span m="918510">that</span> <span m="918690">transformation</span> <span m="919410">and</span> <span m="919500">this</span> <span m="919710">is</span> <span m="919830">not</span> <span m="920010">negative,</span> <span m="921280">then</span> <span m="921420">we're</span> <span m="921540">done.</span> <span m="922500">We're</span> <span m="922650">done</span> <span m="922980">because</span> <span m="923490">we</span> <span m="923610">can</span> <span m="923760">just</span> <span m="923970">run</span> <span m="925620">Dijkstra</span> <span m="926220">V</span> <span m="926565">times</span> <span m="926910">on</span> <span m="927060">that</span> <span m="927210">new</span> <span m="927420">graph,</span> <span m="930260">get</span> <span m="930560">the</span> <span m="930650">shortest</span> <span m="930980">path</span> <span m="931220">distances,</span> <span m="932940">construct</span> <span m="933600">a</span> <span m="933690">shortest</span> <span m="934110">path</span> <span m="934440">tree</span> <span m="934800">from</span> <span m="934980">those</span> <span m="935220">distances,</span> <span m="936360">and</span> <span m="936600">then</span> <span m="936750">traverse</span> <span m="937290">that</span> <span m="937500">tree</span> <span m="937920">in</span> <span m="938220">the</span> <span m="939030">original</span> <span m="939630">graph,</span> <span m="940290">and</span> <span m="940560">compute</span> <span m="941670">shortest</span> <span m="942120">paths</span> <span m="942540">along</span> <span m="942870">that</span> <span m="943050">tree.</span> <span m="943320">So</span> <span m="943470">that's</span> <span m="944400">the</span> <span m="944460">claim.</span></p>
<p><span m="945780">Claim--</span> <span m="954600">we</span> <span m="954810">can</span> <span m="955020">compute</span> <span m="959760">distances</span> <span m="962310">in</span> <span m="962595">G--</span> <span m="965270">so</span> <span m="965720">we're</span> <span m="965870">going</span> <span m="965990">to</span> <span m="966080">restrict</span> <span m="967100">G</span> <span m="967340">prime</span> <span m="967700">to</span> <span m="967880">have</span> <span m="969360">with</span> <span m="974060">non-negative</span> <span m="974810">edge</span> <span m="975170">weights.</span> <span m="983290">If</span> <span m="983710">we</span> <span m="983980">have</span> <span m="984460">such</span> <span m="984760">a</span> <span m="984850">G</span> <span m="985120">prime</span> <span m="985600">with</span> <span m="985840">non-negative</span> <span m="986380">edge</span> <span m="986830">weights, we</span> <span m="987040">can</span> <span m="987220">compute</span> <span m="987580">distances</span> <span m="988150">in</span> <span m="988270">G</span> <span m="989290">from</span> <span m="991210">distances</span> <span m="994150">in</span> <span m="995205">G</span> <span m="995540">prime</span> <span m="996850">in</span> <span m="999070">V</span> <span m="1000240">times</span> <span m="1002190">V</span> <span m="1003540">plus</span> <span m="1004170">E,</span> <span m="1008680">which</span> <span m="1008950">is</span> <span m="1009040">smaller</span> <span m="1009520">than</span> <span m="1009700">our</span> <span m="1009790">Dijkstra</span> <span m="1010210">running</span> <span m="1010480">time.</span> <span m="1011200">This</span> <span m="1011380">is</span> <span m="1011470">our</span> <span m="1011560">Dijkstra</span> <span m="1011950">running</span> <span m="1012190">time.</span> <span m="1013540">And</span> <span m="1013810">this</span> <span m="1013990">is</span> <span m="1014080">smaller</span> <span m="1014530">than</span> <span m="1014680">that.</span></p>
<p><span m="1015530">So</span> <span m="1017170">that</span> <span m="1017380">would</span> <span m="1017500">be</span> <span m="1017620">fine,</span> <span m="1017950">right?</span> <span m="1018220">What</span> <span m="1018370">do</span> <span m="1018430">we</span> <span m="1018580">do?</span> <span m="1020010">We</span> <span m="1020250">have</span> <span m="1020670">our</span> <span m="1021660">new</span> <span m="1021990">graph</span> <span m="1022350">G</span> <span m="1022590">prime.</span> <span m="1023580">It</span> <span m="1023820">has</span> <span m="1024000">all</span> <span m="1024119">positive</span> <span m="1024690">edge</span> <span m="1024839">weights,</span> <span m="1025079">so</span> <span m="1025260">we</span> <span m="1025740">run</span> <span m="1026069">all-pairs</span> <span m="1026430">shortest</span> <span m="1026790">paths</span> <span m="1027089">in</span> <span m="1027240">here</span> <span m="1027540">by</span> <span m="1028500">just</span> <span m="1028740">running</span> <span m="1029040">Dijkstra</span> <span m="1029490">V</span> <span m="1029670">times.</span> <span m="1030780">And</span> <span m="1031020">then</span> <span m="1031170">for</span> <span m="1031349">each</span> <span m="1032280">vertex</span> <span m="1033000">s,</span> <span m="1034260">we</span> <span m="1034440">have</span> <span m="1034589">some</span> <span m="1035490">shortest</span> <span m="1036000">path</span> <span m="1036390">tree</span> <span m="1037050">to</span> <span m="1037230">all</span> <span m="1037349">the</span> <span m="1037470">things</span> <span m="1037740">that it's</span> <span m="1038010">connected</span> <span m="1038460">to.</span></p>
<p><span m="1040079">We</span> <span m="1040290">can</span> <span m="1040470">look</span> <span m="1040710">at</span> <span m="1040800">that</span> <span m="1041040">path</span> <span m="1042599">in</span> <span m="1042900">G.</span> <span m="1044920">This</span> <span m="1045130">is</span> <span m="1045190">the</span> <span m="1045310">same</span> <span m="1046089">common</span> <span m="1046540">[INAUDIBLE]</span> <span m="1046900">graph,</span> <span m="1047200">just</span> <span m="1047380">with</span> <span m="1047530">different</span> <span m="1047829">edge</span> <span m="1048010">weights.</span> <span m="1048850">We</span> <span m="1049060">can</span> <span m="1049240">look</span> <span m="1049480">at</span> <span m="1049570">that</span> <span m="1049780">same</span> <span m="1050050">tree.</span> <span m="1051130">I'm</span> <span m="1051400">not</span> <span m="1051610">going</span> <span m="1051760">to</span> <span m="1051850">be</span> <span m="1052270">able</span> <span m="1052510">to</span> <span m="1052630">draw</span> <span m="1052960">the</span> <span m="1053110">exact</span> <span m="1053470">same</span> <span m="1053710">tree</span> <span m="1053950">here.</span> <span m="1055870">But</span> <span m="1055990">what</span> <span m="1056170">I</span> <span m="1056230">can</span> <span m="1056410">do</span> <span m="1056620">is</span> <span m="1056740">I</span> <span m="1056860">can</span> <span m="1057010">just</span> <span m="1058090">BFS</span> <span m="1058750">or</span> <span m="1058840">DFS</span> <span m="1059410">along</span> <span m="1059770">this</span> <span m="1060010">tree.</span></p>
<p><span m="1061570">And</span> <span m="1061870">every</span> <span m="1062110">time</span> <span m="1062440">I</span> <span m="1062830">have</span> <span m="1063130">an</span> <span m="1063220">edge,</span> <span m="1063520">because</span> <span m="1063820">each</span> <span m="1064000">one</span> <span m="1064150">of</span> <span m="1064240">these</span> <span m="1064480">is</span> <span m="1064600">the</span> <span m="1064660">shortest</span> <span m="1065140">path</span> <span m="1065980">in</span> <span m="1066280">this</span> <span m="1066520">tree,</span> <span m="1067270">I</span> <span m="1067480">can</span> <span m="1067660">just</span> <span m="1067960">compute</span> <span m="1069310">every</span> <span m="1069640">time</span> <span m="1069880">I</span> <span m="1069970">traverse</span> <span m="1070390">an</span> <span m="1070480">edge</span> <span m="1073480">what</span> <span m="1073780">its</span> <span m="1073930">shortest</span> <span m="1074290">path</span> <span m="1074560">distance is</span> <span m="1075160">in</span> <span m="1075250">G</span> <span m="1076090">in</span> <span m="1076300">linear</span> <span m="1076660">time</span> <span m="1077020">for</span> <span m="1077170">that</span> <span m="1077350">vertex</span> <span m="1077830">for</span> <span m="1078010">that</span> <span m="1078190">particular</span> <span m="1078850">s.</span> <span m="1079570">I</span> <span m="1079780">do</span> <span m="1079930">that</span> <span m="1080140">over</span> <span m="1080380">all</span> <span m="1080620">s's,</span> <span m="1082410">and</span> <span m="1082710">I</span> <span m="1082800">get</span> <span m="1083010">this</span> <span m="1083190">running</span> <span m="1083460">time.</span> <span m="1084570">So</span> <span m="1084780">that's</span> <span m="1085050">the</span> <span m="1085140">goal</span> <span m="1085440">here.</span></p>
<p><span m="1086550">All</span> <span m="1086700">right,</span> <span m="1086940">so</span> <span m="1087240">we</span> <span m="1087420">first</span> <span m="1087780">wanted</span> <span m="1088050">to</span> <span m="1088170">find--</span> <span m="1090860">we</span> <span m="1091040">were</span> <span m="1091160">wanting</span> <span m="1091430">to</span> <span m="1091550">make</span> <span m="1091940">edge</span> <span m="1092435">weights</span> <span m="1092930">non-negative</span> <span m="1093830">while</span> <span m="1094010">preserving</span> <span m="1094520">shortest</span> <span m="1094820">paths.</span> <span m="1095510">Because</span> <span m="1096350">if</span> <span m="1096650">we</span> <span m="1096800">could</span> <span m="1096950">do</span> <span m="1097160">that,</span> <span m="1097850">we</span> <span m="1098090">could</span> <span m="1098240">solve</span> <span m="1098660">our</span> <span m="1098960">original</span> <span m="1099690">all-pairs</span> <span m="1100040">shortest</span> <span m="1100400">paths</span> <span m="1100700">problem.</span> <span m="1102650">So</span> <span m="1102860">this</span> <span m="1103040">is</span> <span m="1103340">the</span> <span m="1103520">proof</span> <span m="1104660">sketch.</span> <span m="1109890">But</span> <span m="1110130">how</span> <span m="1110310">can</span> <span m="1110460">we</span> <span m="1110550">do</span> <span m="1110730">this?</span></p>
<p><span m="1111780">But</span> <span m="1112230">how?</span> <span m="1115260">It</span> <span m="1115470">doesn't</span> <span m="1115710">even</span> <span m="1115920">seem</span> <span m="1116130">like</span> <span m="1116280">this</span> <span m="1117030">could</span> <span m="1117270">be</span> <span m="1117390">possible,</span> <span m="1118020">generally.</span> <span m="1119490">How</span> <span m="1119760">can</span> <span m="1119970">I</span> <span m="1120120">just</span> <span m="1120360">reweight</span> <span m="1120900">the</span> <span m="1121050">edges</span> <span m="1121800">and</span> <span m="1122400">maintain</span> <span m="1122970">that</span> <span m="1123120">the</span> <span m="1123210">shortest</span> <span m="1123540">path</span> <span m="1123840">trees</span> <span m="1124290">are</span> <span m="1124410">the</span> <span m="1124470">same?</span> <span m="1125580">That</span> <span m="1125790">seems</span> <span m="1126240">hard</span> <span m="1126480">to</span> <span m="1126600">do.</span> <span m="1127160">And</span> <span m="1127290">in</span> <span m="1127410">particular,</span> <span m="1129560">if</span> <span m="1129850">there's</span> <span m="1130750">a</span> <span m="1130810">negative</span> <span m="1131200">weight</span> <span m="1131440">cycle</span> <span m="1131890">in</span> <span m="1132010">this</span> <span m="1132160">graph,</span> <span m="1132670">it's</span> <span m="1132940">impossible</span> <span m="1133510">to</span> <span m="1133630">do.</span></p>
<p><span m="1134860">So</span> <span m="1135100">claim--</span> <span m="1139220">not</span> <span m="1140120">possible</span> <span m="1143660">if</span> <span m="1144860">G</span> <span m="1146060">contains</span> <span m="1149560">a</span> <span m="1149800">negative</span> <span m="1150260">weight</span> <span m="1150490">cycle.</span> <span m="1159090">OK,</span> <span m="1159330">the</span> <span m="1160590">exclamation</span> <span m="1161400">point</span> <span m="1161670">is</span> <span m="1161790">just</span> <span m="1162270">my</span> <span m="1162540">comment</span> <span m="1162990">here.</span> <span m="1165940">So</span> <span m="1166650">if</span> <span m="1167010">G</span> <span m="1167190">contains</span> <span m="1167670">a</span> <span m="1167770">negative weight</span> <span m="1168170">cycle,</span> <span m="1168690">then</span> <span m="1168930">in</span> <span m="1169050">particular,</span> <span m="1170700">the</span> <span m="1170880">shortest</span> <span m="1171450">path</span> <span m="1171810">distance</span> <span m="1172590">or</span> <span m="1172860">a</span> <span m="1173010">shortest</span> <span m="1173430">path</span> <span m="1174470">in</span> <span m="1174880">G--</span> <span m="1177300">if</span> <span m="1177540">this</span> <span m="1177720">is</span> <span m="1177840">G,</span> <span m="1178950">say</span> <span m="1179280">we</span> <span m="1179400">have</span> <span m="1179580">a</span> <span m="1179910">negative</span> <span m="1180340">weight</span> <span m="1180570">cycle</span> <span m="1182010">directed</span> <span m="1182520">cycle</span> <span m="1183010">C</span> <span m="1183420">here.</span></p>
<p><span m="1184990">In</span> <span m="1185230">particular,</span> <span m="1186100">the</span> <span m="1186250">shortest</span> <span m="1186730">path</span> <span m="1187780">from</span> <span m="1188440">this</span> <span m="1188710">vertex</span> <span m="1189340">on</span> <span m="1189490">the</span> <span m="1189550">cycle</span> <span m="1190390">to</span> <span m="1190600">this</span> <span m="1190840">vertex</span> <span m="1191350">on</span> <span m="1191500">the</span> <span m="1191560">cycle,</span> <span m="1194890">what</span> <span m="1195130">is</span> <span m="1195370">its</span> <span m="1195550">shortest</span> <span m="1195850">path?</span> <span m="1196330">It's</span> <span m="1197320">infinite.</span> <span m="1198730">A</span> <span m="1199000">shortest</span> <span m="1199390">path</span> <span m="1199660">is</span> <span m="1199810">infinite</span> <span m="1200380">around</span> <span m="1200890">this</span> <span m="1201040">cycle.</span> <span m="1201460">You</span> <span m="1201580">just</span> <span m="1201760">keep</span> <span m="1201940">going</span> <span m="1202210">around</span> <span m="1202420">the</span> <span m="1202480">cycle</span> <span m="1203080">over</span> <span m="1203440">and</span> <span m="1203560">over</span> <span m="1203740">and</span> <span m="1203830">over</span> <span m="1204010">again</span> <span m="1204190">because</span> <span m="1204410">it has a</span> <span m="1204610">negative</span> <span m="1204940">weight.</span> <span m="1206560">Weight</span> <span m="1207310">of</span> <span m="1207760">C</span> <span m="1208600">is</span> <span m="1209140">less</span> <span m="1209440">than</span> <span m="1211150">0,</span> <span m="1211600">strictly.</span> <span m="1212530">That's</span> <span m="1212740">what</span> <span m="1212920">a</span> <span m="1212950">negative weight</span> <span m="1213400">cycle</span> <span m="1213730">is.</span></p>
<p><span m="1214420">OK,</span> <span m="1214900">so</span> <span m="1215290">the</span> <span m="1215410">shortest</span> <span m="1215890">path--</span> <span m="1216340">a</span> <span m="1216640">shortest</span> <span m="1217090">path</span> <span m="1217420">from</span> <span m="1217630">s</span> <span m="1217810">to</span> <span m="1217930">t</span> <span m="1218650">has</span> <span m="1218920">infinite</span> <span m="1219310">length</span> <span m="1219640">and,</span> <span m="1219760">in</span> <span m="1219910">particular,</span> <span m="1220780">is</span> <span m="1221050">non-simple.</span> <span m="1223200">However--</span> <span m="1227790">so</span> <span m="1233440">shortest</span> <span m="1235840">path</span> <span m="1237760">from</span> <span m="1239320">s</span> <span m="1239680">to</span> <span m="1239830">t</span> <span m="1241000">is</span> <span m="1242080">non-simple.</span> <span m="1248690">But</span> <span m="1248900">as</span> <span m="1249050">we</span> <span m="1249200">proved</span> <span m="1250100">in</span> <span m="1250610">the</span> <span m="1250760">last</span> <span m="1251120">lecture,</span> <span m="1252350">shortest</span> <span m="1252860">paths</span> <span m="1257950">in</span> <span m="1258820">a</span> <span m="1259420">graph</span> <span m="1262070">with</span> <span m="1265100">non-negative</span> <span m="1266000">weights</span> <span m="1269570">are</span> <span m="1269780">what?</span> <span m="1270500">Are</span> <span m="1270680">simple,</span> <span m="1271160">right?</span> <span m="1271880">Because</span> <span m="1272090">they're</span> <span m="1272270">just</span> <span m="1272480">shortest</span> <span m="1272780">path</span> <span m="1273140">trees.</span> <span m="1280020">So</span> <span m="1280230">that's</span> <span m="1280440">a</span> <span m="1280500">contradiction.</span> <span m="1282780">So</span> <span m="1283460">this</span> <span m="1283730">is</span> <span m="1283820">not</span> <span m="1284030">possible.</span></p>
<p><span m="1287070">So</span> <span m="1288510">given</span> <span m="1288960">a</span> <span m="1289020">graph</span> <span m="1290250">with</span> <span m="1291690">negative</span> <span m="1292200">weights</span> <span m="1292500">but</span> <span m="1292800">no</span> <span m="1293220">negative</span> <span m="1293640">cycle,</span> <span m="1294330">it's</span> <span m="1294630">still</span> <span m="1295020">not</span> <span m="1295260">clear</span> <span m="1295920">how</span> <span m="1296250">we</span> <span m="1296370">could</span> <span m="1296520">find</span> <span m="1296940">such</span> <span m="1297240">a</span> <span m="1297300">reweighting</span> <span m="1297810">of</span> <span m="1297930">the</span> <span m="1298020">graph.</span> <span m="1299390">Can</span> <span m="1299680">we</span> <span m="1299830">do</span> <span m="1300040">this?</span> <span m="1301190">Well,</span> <span m="1301750">we're</span> <span m="1301960">going</span> <span m="1302080">to</span> <span m="1302140">exploit</span> <span m="1302890">a</span> <span m="1303070">little</span> <span m="1303280">idea</span> <span m="1303670">here.</span> <span m="1305150">How</span> <span m="1305450">can</span> <span m="1305660">we</span> <span m="1306320">transform</span> <span m="1307550">the</span> <span m="1307700">weights</span> <span m="1308000">of</span> <span m="1308090">a</span> <span m="1308150">path?</span></p>
<p><span m="1308810">Well,</span> <span m="1309200">how--</span> <span m="1310690">what's</span> <span m="1311020">a--</span> <span m="1311500">a</span> <span m="1311770">silly</span> <span m="1312220">idea,</span> <span m="1313120">I</span> <span m="1313360">have</span> <span m="1313540">this</span> <span m="1313720">silly</span> <span m="1314140">idea.</span> <span m="1315370">If</span> <span m="1315640">I</span> <span m="1315730">don't</span> <span m="1315910">want</span> <span m="1316180">negative</span> <span m="1316660">edge</span> <span m="1316915">weights</span> <span m="1317170">in</span> <span m="1317290">this</span> <span m="1317440">graph--</span> <span m="1318315">ugh,</span> <span m="1318620">this</span> <span m="1318820">is</span> <span m="1318940">messy</span> <span m="1319480">in</span> <span m="1319690">the</span> <span m="1319750">back.</span> <span m="1320290">You</span> <span m="1320440">got</span> <span m="1320590">edge weights</span> <span m="1320980">1,</span> <span m="1321430">minus</span> <span m="1321850">2,</span> <span m="1322060">0,</span> <span m="1322540">1,</span> <span m="1323350">4,</span> <span m="1323890">5,</span> <span m="1324610">and</span> <span m="1324850">1.</span> <span m="1326700">There's</span> <span m="1326940">only</span> <span m="1327120">one</span> <span m="1327330">negative</span> <span m="1327800">edge weight</span> <span m="1328140">here.</span></p>
<p><span m="1330270">What</span> <span m="1330540">if</span> <span m="1330720">I</span> <span m="1330840">just</span> <span m="1331560">added</span> <span m="1332580">a</span> <span m="1333210">large</span> <span m="1333600">number,</span> <span m="1334170">or</span> <span m="1334350">in</span> <span m="1334470">particular,</span> <span m="1336630">the</span> <span m="1337470">negative</span> <span m="1338190">of</span> <span m="1338340">the</span> <span m="1338490">smallest</span> <span m="1339240">edge</span> <span m="1339420">in</span> <span m="1339510">my</span> <span m="1339660">graph</span> <span m="1340560">to</span> <span m="1340770">every</span> <span m="1341430">edge</span> <span m="1341820">in</span> <span m="1341970">my</span> <span m="1342120">graph?</span> <span m="1343200">Then</span> <span m="1343500">I'll</span> <span m="1343620">have</span> <span m="1343770">a</span> <span m="1343830">graph</span> <span m="1344430">with</span> <span m="1344880">non-negative</span> <span m="1345510">weights.</span> <span m="1346500">Fantastic.</span> <span m="1349060">Why</span> <span m="1349330">is</span> <span m="1349450">that</span> <span m="1349600">not</span> <span m="1349780">a</span> <span m="1349840">good</span> <span m="1350020">idea?</span></p>
<p><span m="1352400">Well,</span> <span m="1352610">in</span> <span m="1352700">particular,</span> <span m="1353430">if</span> <span m="1353480">I</span> <span m="1353570">did</span> <span m="1353750">that</span> <span m="1353900">to</span> <span m="1354020">this</span> <span m="1354200">graph,</span> <span m="1354500">if</span> <span m="1354620">I added</span> <span m="1355085">2</span> <span m="1355550">to</span> <span m="1355700">every</span> <span m="1356090">edge,</span> <span m="1358130">the</span> <span m="1358280">weight</span> <span m="1358520">of</span> <span m="1358640">this</span> <span m="1359120">path,</span> <span m="1359640">which</span> <span m="1359750">was</span> <span m="1360050">the</span> <span m="1360140">shortest</span> <span m="1360560">path,</span> <span m="1362110">changed</span> <span m="1362620">from</span> <span m="1362860">weight</span> <span m="1363340">3</span> <span m="1365800">to</span> <span m="1366010">weight</span> <span m="1367960">9,</span> <span m="1368710">because</span> <span m="1368980">I</span> <span m="1369070">added</span> <span m="1369430">2</span> <span m="1369760">for</span> <span m="1369940">every</span> <span m="1370960">edge.</span> <span m="1372660">But</span> <span m="1372900">this</span> <span m="1373260">path,</span> <span m="1373870">which</span> <span m="1373980">wasn't</span> <span m="1374400">a</span> <span m="1374460">shortest</span> <span m="1374850">path</span> <span m="1375120">in</span> <span m="1375240">the</span> <span m="1375300">original</span> <span m="1375630">graph--</span> <span m="1375990">it</span> <span m="1376170">had</span> <span m="1376290">weight</span> <span m="1376500">4--</span> <span m="1378640">increased</span> <span m="1379210">only</span> <span m="1379450">by</span> <span m="1379630">2.</span> <span m="1379830">Now</span> <span m="1381130">that</span> <span m="1381370">is</span> <span m="1381520">a</span> <span m="1381610">shortest</span> <span m="1381970">path.</span> <span m="1382360">Or</span> <span m="1382690">it's</span> <span m="1382930">a</span> <span m="1383050">shorter</span> <span m="1383530">path</span> <span m="1383890">than</span> <span m="1384070">this</span> <span m="1384310">one,</span> <span m="1384890">so</span> <span m="1385060">this</span> <span m="1385270">one</span> <span m="1385420">can't</span> <span m="1385720">be a</span> <span m="1385870">shortest</span> <span m="1386350">path.</span></p>
<p><span m="1388090">So</span> <span m="1388300">that</span> <span m="1388450">transformation,</span> <span m="1389710">sure,</span> <span m="1390160">would</span> <span m="1390310">make</span> <span m="1390610">all</span> <span m="1390730">the</span> <span m="1391010">weights</span> <span m="1391660">non-negative,</span> <span m="1392920">but</span> <span m="1393160">would</span> <span m="1393280">not</span> <span m="1393550">preserve</span> <span m="1394150">shortest</span> <span m="1394540">paths.</span> <span m="1396680">In</span> <span m="1396910">particular,</span> <span m="1397850">if</span> <span m="1398020">I</span> <span m="1398200">added</span> <span m="1400330">the</span> <span m="1400480">same</span> <span m="1401200">edge</span> <span m="1401470">weight</span> <span m="1401740">to</span> <span m="1401920">every</span> <span m="1402370">edge,</span> <span m="1403390">I</span> <span m="1403660">will</span> <span m="1403810">bias</span> <span m="1404590">toward</span> <span m="1405280">taking</span> <span m="1405760">paths</span> <span m="1406660">that</span> <span m="1406900">have</span> <span m="1407380">fewer</span> <span m="1408040">edges,</span> <span m="1408610">not</span> <span m="1408940">just</span> <span m="1409210">smaller</span> <span m="1409600">weight.</span> <span m="1411110">So</span> <span m="1411290">that</span> <span m="1411470">first</span> <span m="1411800">idea</span> <span m="1412100">doesn't</span> <span m="1412370">work.</span></p>
<p><span m="1414560">Idea--</span> <span m="1417820">add</span> <span m="1419770">large</span> <span m="1421660">number</span> <span m="1422830">to</span> <span m="1423820">each</span> <span m="1425140">edge.</span> <span m="1429120">This</span> <span m="1429360">is</span> <span m="1429450">bad.</span> <span m="1431940">Makes</span> <span m="1434580">weights</span> <span m="1437670">non-negative,</span> <span m="1440610">but</span> <span m="1443970">does</span> <span m="1445470">not</span> <span m="1447060">preserve</span> <span m="1450130">shortest</span> <span m="1450640">paths.</span> <span m="1452030">So</span> <span m="1452110">this</span> <span m="1452320">is</span> <span m="1452510">not</span> <span m="1454470">a</span> <span m="1455010">good</span> <span m="1455400">idea--</span> <span m="1455880">bad</span> <span m="1456180">idea.</span> <span m="1459540">Is</span> <span m="1459780">there</span> <span m="1460050">any</span> <span m="1460410">way</span> <span m="1460650">you</span> <span m="1460800">can</span> <span m="1460980">think</span> <span m="1461310">of</span> <span m="1462060">to</span> <span m="1462240">modify</span> <span m="1462840">the</span> <span m="1462990">edge</span> <span m="1463305">weights</span> <span m="1463620">in a</span> <span m="1463680">graph</span> <span m="1464160">in</span> <span m="1464370">any</span> <span m="1464670">way</span> <span m="1466110">that</span> <span m="1466350">will</span> <span m="1466470">preserve</span> <span m="1466950">shortest</span> <span m="1467280">paths?</span></p>
<p><span m="1469050">So</span> <span m="1469190">here</span> <span m="1469370">is</span> <span m="1469550">an</span> <span m="1472540">idea</span> <span m="1473020">for</span> <span m="1473290">you,</span> <span m="1476840">which</span> <span m="1477040">is</span> <span m="1477160">kind</span> <span m="1477370">of</span> <span m="1477460">this</span> <span m="1477610">critical</span> <span m="1478090">step</span> <span m="1478510">in</span> <span m="1478720">Johnson's</span> <span m="1479530">and</span> <span m="1479920">in a</span> <span m="1480040">lot</span> <span m="1480280">of</span> <span m="1480370">graph</span> <span m="1480670">transformation</span> <span m="1481330">algorithms.</span> <span m="1483550">If</span> <span m="1483790">I</span> <span m="1484240">have</span> <span m="1484540">a</span> <span m="1484600">vertex,</span> <span m="1485230">say</span> <span m="1485470">this</span> <span m="1485680">middle</span> <span m="1485950">guy,</span> <span m="1487360">say</span> <span m="1487620">v,</span> <span m="1491290">every</span> <span m="1491770">path</span> <span m="1495290">from</span> <span m="1495800">v</span> <span m="1496130">goes</span> <span m="1496490">through</span> <span m="1498190">an</span> <span m="1498460">outgoing</span> <span m="1498745">edge</span> <span m="1499030">of</span> <span m="1499300">v.</span> <span m="1500620">And</span> <span m="1500860">every</span> <span m="1501100">path</span> <span m="1501400">going</span> <span m="1501730">into</span> <span m="1502270">v</span> <span m="1504670">goes</span> <span m="1505000">through</span> <span m="1505690">an</span> <span m="1505930">edge</span> <span m="1506860">going</span> <span m="1507220">into</span> <span m="1507490">v.</span></p>
<p><span m="1508570">I</span> <span m="1508840">haven't</span> <span m="1509080">said</span> <span m="1509320">anything--</span> <span m="1511180">I've</span> <span m="1511420">said</span> <span m="1511600">very</span> <span m="1511810">stupid</span> <span m="1512140">things.</span> <span m="1513020">But</span> <span m="1513160">that</span> <span m="1513340">observation</span> <span m="1514060">is</span> <span m="1514180">critical</span> <span m="1514630">here.</span> <span m="1515680">If</span> <span m="1516610">I</span> <span m="1517120">add</span> <span m="1517600">a</span> <span m="1517660">number--</span> <span m="1518740">or</span> <span m="1519100">let</span> <span m="1519280">me</span> <span m="1519400">see</span> <span m="1519550">if</span> <span m="1519700">I</span> <span m="1519790">got</span> <span m="1519970">this</span> <span m="1520150">right</span> <span m="1520480">in</span> <span m="1520660">terms</span> <span m="1520960">of</span> <span m="1521260">adding</span> <span m="1521650">and</span> <span m="1521740">subtracting.</span> <span m="1524320">If</span> <span m="1524620">I</span> <span m="1524830">add</span> <span m="1526060">a</span> <span m="1526270">number</span> <span m="1526720">to</span> <span m="1526960">all</span> <span m="1527200">outgoing</span> <span m="1527920">edges</span> <span m="1528220">from</span> <span m="1528430">a</span> <span m="1528490">vertex,</span> <span m="1529940">and</span> <span m="1530050">I</span> <span m="1530140">subtract</span> <span m="1530860">that</span> <span m="1531070">same</span> <span m="1531460">number</span> <span m="1533620">from</span> <span m="1535060">the</span> <span m="1535150">weights</span> <span m="1535510">of</span> <span m="1535630">all</span> <span m="1535810">of</span> <span m="1535930">the</span> <span m="1536050">incoming</span> <span m="1536530">edges</span> <span m="1536830">to</span> <span m="1536950">that</span> <span m="1537100">vertex,</span> <span m="1538600">then</span> <span m="1538960">every</span> <span m="1539380">path</span> <span m="1539800">from</span> <span m="1540430">v</span> <span m="1541810">is</span> <span m="1542050">changed</span> <span m="1542620">by</span> <span m="1542830">the</span> <span m="1542920">same</span> <span m="1543220">amount,</span> <span m="1543640">because</span> <span m="1544390">every</span> <span m="1544810">path</span> <span m="1545080">from</span> <span m="1545350">v</span> <span m="1545530">goes</span> <span m="1545830">through</span> <span m="1546070">one</span> <span m="1546250">of</span> <span m="1546340">those</span> <span m="1546490">outgoing</span> <span m="1546880">edges.</span></p>
<p><span m="1547990">And</span> <span m="1548380">any</span> <span m="1548890">path</span> <span m="1549280">going</span> <span m="1549580">into</span> <span m="1549910">v</span> <span m="1550810">has</span> <span m="1551140">also</span> <span m="1551440">changed</span> <span m="1551950">by</span> <span m="1552250">the</span> <span m="1552370">same</span> <span m="1552640">amount.</span> <span m="1553450">In</span> <span m="1553660">particular,</span> <span m="1554290">it's</span> <span m="1554530">changed</span> <span m="1554950">by</span> <span m="1556210">a</span> <span m="1556360">negative,</span> <span m="1557440">whatever</span> <span m="1557950">we</span> <span m="1558130">added</span> <span m="1558520">to</span> <span m="1558700">the</span> <span m="1558820">outgoing</span> <span m="1559210">edges.</span> <span m="1561480">So</span> <span m="1562740">such</span> <span m="1563160">a</span> <span m="1563220">transformation,</span> <span m="1565460">adding</span> <span m="1565910">a</span> <span m="1565970">number</span> <span m="1566240">from</span> <span m="1566450">all</span> <span m="1566600">the</span> <span m="1566750">outgoing</span> <span m="1567290">edges</span> <span m="1567920">from</span> <span m="1568250">a</span> <span m="1568310">vertex</span> <span m="1569130">and</span> <span m="1569480">subtracting</span> <span m="1570140">that</span> <span m="1570290">same</span> <span m="1570500">number</span> <span m="1570770">from</span> <span m="1571040">all</span> <span m="1571130">the</span> <span m="1571280">incoming</span> <span m="1572060">edges,</span> <span m="1573140">preserves</span> <span m="1573660">shortest</span> <span m="1574040">paths.</span> <span m="1574460">That's</span> <span m="1574670">a</span> <span m="1574700">claim.</span></p>
<p><span m="1575480">Idea--</span> <span m="1578770">this</span> <span m="1578950">is</span> <span m="1579030">a</span> <span m="1579090">better</span> <span m="1579420">idea.</span> <span m="1585150">Given</span> <span m="1586870">vertex</span> <span m="1589000">v,</span> <span m="1592290">add--</span> <span m="1595300">I'm</span> <span m="1595540">going</span> <span m="1595660">to</span> <span m="1596140">put</span> <span m="1596320">this</span> <span m="1596530">on</span> <span m="1596650">two</span> <span m="1596800">lines.</span> <span m="1599180">Add</span> <span m="1600860">weight</span> <span m="1603290">h</span> <span m="1603920">to</span> <span m="1604670">all</span> <span m="1606560">outgoing</span> <span m="1609020">edges,</span> <span m="1615670">and</span> <span m="1616630">subtract</span> <span m="1618910">weight</span> <span m="1619570">to</span> <span m="1619900">all</span> <span m="1621310">incoming</span> <span m="1624030">edges.</span> <span m="1627310">So</span> <span m="1627490">that's</span> <span m="1627670">the</span> <span m="1627790">idea.</span> <span m="1629320">And</span> <span m="1629560">the</span> <span m="1629650">claim</span> <span m="1630070">is,</span> <span m="1635670">this</span> <span m="1635910">transformation,</span> <span m="1639040">shortest</span> <span m="1639550">paths</span> <span m="1646340">are</span> <span m="1646790">preserved</span> <span m="1652910">under</span> <span m="1655310">this</span> <span m="1658130">transformation.</span></p>
<p><span m="1665870">And</span> <span m="1666140">why</span> <span m="1666440">is</span> <span m="1666620">that?</span> <span m="1668290">It's</span> <span m="1668560">kind</span> <span m="1668770">of</span> <span m="1668860">the</span> <span m="1669010">exact</span> <span m="1669310">same</span> <span m="1669550">argument</span> <span m="1670000">that</span> <span m="1670180">I</span> <span m="1670330">had</span> <span m="1670540">over</span> <span m="1670780">there.</span> <span m="1672280">Proof--</span> <span m="1678080">consider</span> <span m="1678590">any</span> <span m="1678830">path</span> <span m="1679160">in</span> <span m="1679280">my</span> <span m="1679430">graph,</span> <span m="1681230">either</span> <span m="1687710">if</span> <span m="1688070">the</span> <span m="1688190">path--</span> <span m="1690690">path</span> <span m="1691190">could</span> <span m="1691430">go</span> <span m="1691670">through</span> <span m="1691960">v</span> <span m="1692210">many</span> <span m="1692480">times,</span> <span m="1692900">or</span> <span m="1692990">it</span> <span m="1693080">could</span> <span m="1693230">go</span> <span m="1693440">through</span> <span m="1694520">not</span> <span m="1694790">at</span> <span m="1694910">all.</span> <span m="1695540">If</span> <span m="1696170">my</span> <span m="1696440">path,</span> <span m="1697010">if</span> <span m="1697610">I</span> <span m="1697730">have</span> <span m="1697850">a</span> <span m="1697880">path,</span> <span m="1698780">in</span> <span m="1699050">my</span> <span m="1699230">original</span> <span m="1699680">graph</span> <span m="1700040">G,</span> <span m="1703830">then</span> <span m="1704400">with</span> <span m="1704970">path</span> <span m="1705300">weight</span> <span m="1707040">w</span> <span m="1707730">of</span> <span m="1707880">pi--</span> <span m="1708840">this</span> <span m="1709020">is</span> <span m="1709140">my</span> <span m="1709290">path--</span> <span m="1711580">it</span> <span m="1711820">goes</span> <span m="1712210">through</span> <span m="1716252">v</span> <span m="1716750">some</span> <span m="1718430">number</span> <span m="1718700">of</span> <span m="1718790">times.</span></p>
<p><span m="1721390">So</span> <span m="1721720">I'm</span> <span m="1721810">going</span> <span m="1721930">to</span> <span m="1721990">say</span> <span m="1722170">this</span> <span m="1722350">is</span> <span m="1722470">going</span> <span m="1722680">from</span> <span m="1722890">s</span> <span m="1723310">to</span> <span m="1723460">t.</span> <span m="1725640">If</span> <span m="1728460">it</span> <span m="1728730">crosses</span> <span m="1729480">v--</span> <span m="1729870">if</span> <span m="1730080">it</span> <span m="1730140">never</span> <span m="1730440">crosses</span> <span m="1730890">v,</span> <span m="1731010">if</span> <span m="1731130">it</span> <span m="1731220">never</span> <span m="1731610">touches</span> <span m="1732060">v,</span> <span m="1732420">the</span> <span m="1733140">vertex</span> <span m="1733620">that</span> <span m="1733770">I</span> <span m="1733860">transformed,</span> <span m="1735570">then</span> <span m="1735900">I</span> <span m="1736020">argue</span> <span m="1736380">that</span> <span m="1736560">the</span> <span m="1736650">path</span> <span m="1737090">weight</span> <span m="1737220">is the</span> <span m="1737310">same</span> <span m="1738090">because</span> <span m="1738510">I</span> <span m="1738600">didn't</span> <span m="1738780">do</span> <span m="1738930">anything</span> <span m="1739290">to</span> <span m="1739410">edges</span> <span m="1739770">that</span> <span m="1739890">are</span> <span m="1739950">in</span> <span m="1740070">this</span> <span m="1740190">path.</span> <span m="1741400">Alternatively,</span> <span m="1742540">this</span> <span m="1742810">thing</span> <span m="1743110">goes</span> <span m="1743680">through</span> <span m="1744580">v</span> <span m="1745090">sometimes.</span> <span m="1746170">If</span> <span m="1746920">it</span> <span m="1747130">goes</span> <span m="1747400">through v</span> <span m="1747790">in</span> <span m="1747880">the</span> <span m="1747970">middle,</span> <span m="1752660">how</span> <span m="1752930">is</span> <span m="1753050">the</span> <span m="1753140">weight</span> <span m="1753320">of</span> <span m="1753410">my</span> <span m="1753560">path</span> <span m="1753860">changed?</span></p>
<p><span m="1754980">Well,</span> <span m="1755150">it</span> <span m="1755240">hasn't,</span> <span m="1756290">because</span> <span m="1757040">I</span> <span m="1757340">added</span> <span m="1757910">a</span> <span m="1757970">number</span> <span m="1758360">to</span> <span m="1758570">all</span> <span m="1758810">outgoing</span> <span m="1759470">edges,</span> <span m="1759960">so</span> <span m="1760040">there's</span> <span m="1760220">an</span> <span m="1760340">outgoing</span> <span m="1760820">edge</span> <span m="1761060">here</span> <span m="1761720">with</span> <span m="1761960">weight</span> <span m="1763040">I've</span> <span m="1763430">changed</span> <span m="1763910">by</span> <span m="1764090">weight</span> <span m="1764430">h.</span> <span m="1765320">And</span> <span m="1765530">there's</span> <span m="1765710">an</span> <span m="1765830">incoming</span> <span m="1766340">edge</span> <span m="1766580">here</span> <span m="1766820">that</span> <span m="1766970">I've</span> <span m="1767090">changed</span> <span m="1767390">by</span> <span m="1767600">weight</span> <span m="1767870">negative</span> <span m="1768440">h.</span> <span m="1769020">So</span> <span m="1769130">these</span> <span m="1769340">cancel</span> <span m="1769730">out</span> <span m="1769940">and</span> <span m="1770030">you've</span> <span m="1770300">got</span> <span m="1770480">0.</span> <span m="1772280">So</span> <span m="1772970">passing</span> <span m="1773540">through</span> <span m="1774020">a</span> <span m="1774080">vertex</span> <span m="1775890">doesn't</span> <span m="1776250">change</span> <span m="1777510">the</span> <span m="1777660">weight</span> <span m="1777840">of</span> <span m="1777900">my</span> <span m="1778020">path.</span></p>
<p><span m="1779130">The</span> <span m="1779280">only</span> <span m="1779640">way</span> <span m="1780000">I</span> <span m="1780120">could</span> <span m="1780360">change</span> <span m="1780780">the</span> <span m="1780840">weight</span> <span m="1781050">of</span> <span m="1781110">my</span> <span m="1781260">path</span> <span m="1782040">is</span> <span m="1782340">if</span> <span m="1782520">v</span> <span m="1782730">is</span> <span m="1782880">the</span> <span m="1782970">start</span> <span m="1783390">vertex</span> <span m="1783870">or</span> <span m="1783960">the</span> <span m="1784080">end</span> <span m="1784260">vertex.</span> <span m="1787560">So</span> <span m="1787830">it's</span> <span m="1787950">possible</span> <span m="1788460">that</span> <span m="1788780">s</span> <span m="1789240">is</span> <span m="1789570">my</span> <span m="1789750">vertex</span> <span m="1790290">or</span> <span m="1790440">t</span> <span m="1790920">is</span> <span m="1791160">my</span> <span m="1791340">vertex.</span> <span m="1792720">Well,</span> <span m="1794310">for</span> <span m="1794550">any</span> <span m="1794790">path</span> <span m="1795270">leaving</span> <span m="1796210">v,</span> <span m="1797960">I</span> <span m="1798170">will</span> <span m="1798320">have</span> <span m="1798560">increased</span> <span m="1799580">the</span> <span m="1799790">weight</span> <span m="1800240">of</span> <span m="1800540">that</span> <span m="1801800">path</span> <span m="1802790">by</span> <span m="1803240">h,</span> <span m="1804380">because</span> <span m="1804680">I</span> <span m="1804800">added</span> <span m="1805220">a</span> <span m="1805280">weight</span> <span m="1805520">h</span> <span m="1805790">to</span> <span m="1805910">all</span> <span m="1806150">outgoing</span> <span m="1806570">edges.</span></p>
<p><span m="1807330">So</span> <span m="1807770">again,</span> <span m="1808760">while</span> <span m="1809030">the</span> <span m="1809120">path</span> <span m="1809600">weight</span> <span m="1809870">has</span> <span m="1810110">changed,</span> <span m="1812460">since</span> <span m="1812940">all</span> <span m="1813390">of</span> <span m="1813510">the</span> <span m="1813600">paths</span> <span m="1814140">leaving</span> <span m="1814620">v</span> <span m="1815490">have</span> <span m="1815790">changed</span> <span m="1816240">by</span> <span m="1816390">the</span> <span m="1816480">same</span> <span m="1816750">amount,</span> <span m="1817440">a</span> <span m="1817695">shortest</span> <span m="1818070">path</span> <span m="1818340">will</span> <span m="1818430">still</span> <span m="1818640">be</span> <span m="1818730">a</span> <span m="1819030">shortest</span> <span m="1819120">path.</span> <span m="1819900">And</span> <span m="1820140">same</span> <span m="1820440">goes</span> <span m="1820740">for</span> <span m="1821790">t.</span> <span m="1822180">If</span> <span m="1822390">t,</span> <span m="1822870">the</span> <span m="1823080">end</span> <span m="1823410">vertex</span> <span m="1823920">is</span> <span m="1824070">v,</span> <span m="1824880">I'll</span> <span m="1825120">have</span> <span m="1825210">subtracted</span> <span m="1826260">h</span> <span m="1826950">from</span> <span m="1827430">all</span> <span m="1827910">of</span> <span m="1828150">my</span> <span m="1828420">incoming</span> <span m="1828990">edges,</span> <span m="1829930">which</span> <span m="1830070">means</span> <span m="1830280">that</span> <span m="1830400">any</span> <span m="1831420">path</span> <span m="1831870">ending</span> <span m="1832380">at</span> <span m="1832530">t,</span> <span m="1833100">any</span> <span m="1833400">directed</span> <span m="1833790">path</span> <span m="1834060">ending</span> <span m="1834480">at</span> <span m="1834570">t,</span> <span m="1835740">also</span> <span m="1836160">changes</span> <span m="1836550">by</span> <span m="1836730">the</span> <span m="1836820">same</span> <span m="1837210">value.</span> <span m="1838060">And</span> <span m="1838230">so</span> <span m="1838740">shortest</span> <span m="1839190">paths</span> <span m="1839850">must</span> <span m="1840090">be</span> <span m="1840240">preserved.</span> <span m="1842350">So</span> <span m="1843250">shortest</span> <span m="1844000">paths</span> <span m="1845410">preserved.</span></p>
<p><span m="1850050">So</span> <span m="1850260">that's</span> <span m="1850470">pretty</span> <span m="1850710">cool</span> <span m="1850980">transformation.</span> <span m="1851730">I</span> <span m="1851790">can</span> <span m="1852000">assign</span> <span m="1853200">for</span> <span m="1853410">any</span> <span m="1853650">vertex</span> <span m="1855740">such</span> <span m="1856100">a</span> <span m="1856160">transformation</span> <span m="1857600">which</span> <span m="1857870">affects</span> <span m="1858380">all</span> <span m="1858620">of</span> <span m="1858740">the</span> <span m="1858860">edges</span> <span m="1859130">surrounding</span> <span m="1859670">it</span> <span m="1860180">by</span> <span m="1860930">this</span> <span m="1861200">h</span> <span m="1862040">additive</span> <span m="1862550">factor,</span> <span m="1863810">either</span> <span m="1864260">added</span> <span m="1864620">or</span> <span m="1864710">subtracted.</span> <span m="1866180">So</span> <span m="1866450">maybe--</span> <span m="1866840">and</span> <span m="1866990">I</span> <span m="1867080">can</span> <span m="1867260">do</span> <span m="1867440">this</span> <span m="1867620">independently</span> <span m="1868340">for</span> <span m="1868520">every</span> <span m="1868760">vertex.</span> <span m="1869900">The</span> <span m="1870090">shortest</span> <span m="1870410">paths</span> <span m="1870710">were</span> <span m="1870830">preserved</span> <span m="1871970">by</span> <span m="1872210">me</span> <span m="1872390">doing</span> <span m="1872630">this</span> <span m="1872780">to</span> <span m="1872900">one</span> <span m="1873110">vertex.</span> <span m="1874250">Then</span> <span m="1874460">if</span> <span m="1874550">I</span> <span m="1874640">do</span> <span m="1874790">it</span> <span m="1874880">to</span> <span m="1875000">another</span> <span m="1875330">vertex,</span> <span m="1877270">then</span> <span m="1878140">shortest</span> <span m="1878530">paths</span> <span m="1878770">are</span> <span m="1878860">still</span> <span m="1879070">preserved.</span> <span m="1879580">And</span> <span m="1879880">let's</span> <span m="1880570">prove</span> <span m="1880930">that</span> <span m="1881260">real</span> <span m="1881530">quick.</span></p>
<p><span m="1887980">What</span> <span m="1888280">I'm</span> <span m="1888370">going</span> <span m="1888490">to</span> <span m="1888580">do</span> <span m="1888880">is</span> <span m="1889010">I'm</span> <span m="1889450">going</span> <span m="1889570">to</span> <span m="1889630">want</span> <span m="1889750">to</span> <span m="1889840">do</span> <span m="1890020">this</span> <span m="1890440">to</span> <span m="1890650">give</span> <span m="1890860">me</span> <span m="1891010">flexibility</span> <span m="1891760">for</span> <span m="1891880">changing</span> <span m="1892270">all</span> <span m="1892420">the edge</span> <span m="1892660">weights</span> <span m="1892930">in</span> <span m="1893020">my</span> <span m="1893170">graph</span> <span m="1893950">to</span> <span m="1894130">have</span> <span m="1894340">this</span> <span m="1894550">property.</span> <span m="1896020">I'm</span> <span m="1896230">going</span> <span m="1896350">to</span> <span m="1896440">set--</span> <span m="1899220">or</span> <span m="1899970">define</span> <span m="1903360">a</span> <span m="1904320">potential</span> <span m="1908010">function</span> <span m="1910890">h</span> <span m="1913020">that</span> <span m="1913260">maps</span> <span m="1913770">vertices</span> <span m="1914670">to</span> <span m="1915960">integers.</span> <span m="1924480">So</span> <span m="1924620">this</span> <span m="1924770">is</span> <span m="1924860">the</span> <span m="1924980">potential</span> <span m="1930020">h</span> <span m="1930280">of</span> <span m="1930540">v.</span> <span m="1936390">And</span> <span m="1936630">then</span> <span m="1936780">we're</span> <span m="1936900">going</span> <span m="1937020">to</span> <span m="1937080">make</span> <span m="1937380">a</span> <span m="1937440">graph,</span> <span m="1943860">G</span> <span m="1944350">prime</span> <span m="1949380">based</span> <span m="1951210">on</span> <span m="1952410">above</span> <span m="1954720">transformation</span> <span m="1956760">for</span> <span m="1957930">each</span> <span m="1960060">vertex</span> <span m="1960780">in</span> <span m="1961470">v.</span></p>
<p><span m="1964330">So</span> <span m="1964870">I'm</span> <span m="1965080">going</span> <span m="1965200">to</span> <span m="1965410">set</span> <span m="1966100">a</span> <span m="1966460">number,</span> <span m="1967390">an h</span> <span m="1967750">for</span> <span m="1968560">each</span> <span m="1968890">vertex.</span> <span m="1969670">These</span> <span m="1969910">are</span> <span m="1970000">independent</span> <span m="1970610">now.</span> <span m="1972420">And</span> <span m="1972720">I'm</span> <span m="1972840">going</span> <span m="1972990">to</span> <span m="1973230">add</span> <span m="1973710">that</span> <span m="1974160">potential</span> <span m="1974850">to</span> <span m="1975000">all</span> <span m="1975210">outgoing</span> <span m="1975720">edges.</span> <span m="1976210">And</span> <span m="1976290">I'm</span> <span m="1976380">going</span> <span m="1976500">to</span> <span m="1976560">subtract</span> <span m="1977070">that</span> <span m="1977250">potential</span> <span m="1977730">from</span> <span m="1977940">all</span> <span m="1978120">incoming</span> <span m="1978660">edges.</span> <span m="1980200">This</span> <span m="1980440">transformation</span> <span m="1981100">is</span> <span m="1981160">going</span> <span m="1981310">to</span> <span m="1981370">preserve</span> <span m="1981820">shortest</span> <span m="1982180">paths.</span> <span m="1983470">Let's</span> <span m="1983710">actually</span> <span m="1984670">be</span> <span m="1984790">a</span> <span m="1984880">little</span> <span m="1985090">bit</span> <span m="1985270">more</span> <span m="1985450">rigorous</span> <span m="1985990">that</span> <span m="1986170">that's</span> <span m="1986380">the</span> <span m="1986470">case</span> <span m="1986920">when</span> <span m="1987070">we</span> <span m="1987190">do</span> <span m="1987340">this</span> <span m="1987520">multiple</span> <span m="1987880">times.</span></p>
<p><span m="1989690">So</span> <span m="1990890">claim--</span> <span m="1996450">shortest</span> <span m="1996960">paths</span> <span m="1998430">are</span> <span m="1999240">still</span> <span m="2003340">preserved.</span> <span m="2009620">All</span> <span m="2009770">right,</span> <span m="2009950">well,</span> <span m="2010100">that's,</span> <span m="2010640">again,</span> <span m="2011270">not</span> <span m="2011630">so</span> <span m="2011840">difficult</span> <span m="2012290">to</span> <span m="2012380">see.</span> <span m="2012630">Let's</span> <span m="2013730">consider</span> <span m="2014330">a</span> <span m="2014420">path</span> <span m="2015880">from</span> <span m="2016420">s</span> <span m="2018410">to</span> <span m="2019040">t.</span> <span m="2020362">It</span> <span m="2020800">passes</span> <span m="2021220">through</span> <span m="2021400">a</span> <span m="2021460">bunch</span> <span m="2021730">of</span> <span m="2021820">vertices.</span> <span m="2022165">I'm</span> <span m="2022510">going</span> <span m="2022690">to</span> <span m="2023020">label</span> <span m="2023410">these</span> <span m="2023620">as</span> <span m="2025690">v0</span> <span m="2028050">to</span> <span m="2029220">vk</span> <span m="2030240">so</span> <span m="2030480">that</span> <span m="2030630">I</span> <span m="2030750">can</span> <span m="2031320">kind</span> <span m="2031620">of</span> <span m="2031740">number</span> <span m="2032160">them.</span></p>
<p><span m="2033480">All</span> <span m="2033750">right,</span> <span m="2033930">this</span> <span m="2035256">is</span> <span m="2035698">v1</span> <span m="2036560">here.</span> <span m="2036850">This</span> <span m="2037140">is</span> <span m="2037370">a</span> <span m="2037460">directed</span> <span m="2038000">path,</span> <span m="2039882">v1,</span> <span m="2040510">2,</span> <span m="2040710">3,</span> <span m="2040910">4,</span> <span m="2041310">all</span> <span m="2041490">the</span> <span m="2041550">way</span> <span m="2041670">up</span> <span m="2041790">to</span> <span m="2041910">k.</span> <span m="2043350">There</span> <span m="2043665">are</span> <span m="2043980">k</span> <span m="2044510">edges</span> <span m="2044940">in</span> <span m="2045060">this</span> <span m="2045240">graph.</span> <span m="2047200">I</span> <span m="2047410">claim</span> <span m="2047740">to</span> <span m="2047900">you</span> <span m="2048130">that</span> <span m="2048790">any</span> <span m="2049270">path</span> <span m="2049750">from</span> <span m="2050139">v0</span> <span m="2051460">to</span> <span m="2051699">vk,</span> <span m="2053260">any</span> <span m="2053620">shortest</span> <span m="2054040">path</span> <span m="2054370">from</span> <span m="2054730">v0</span> <span m="2055360">to</span> <span m="2055540">vk</span> <span m="2056199">remains</span> <span m="2056739">a</span> <span m="2056800">shortest</span> <span m="2057159">path</span> <span m="2057940">after</span> <span m="2058469">I</span> <span m="2058880">reweight</span> <span m="2059469">everything</span> <span m="2059870">in</span> <span m="2059949">this</span> <span m="2060639">way.</span></p>
<p><span m="2062699">So</span> <span m="2063330">let's</span> <span m="2063570">say</span> <span m="2063870">this</span> <span m="2064080">is</span> <span m="2064330">path</span> <span m="2064710">pi,</span> <span m="2065400">and</span> <span m="2065639">so</span> <span m="2065820">it</span> <span m="2065909">has</span> <span m="2066239">weight</span> <span m="2066989">w</span> <span m="2067339">pi,</span> <span m="2069000">which</span> <span m="2069239">is</span> <span m="2069360">really</span> <span m="2069600">just</span> <span m="2070560">the</span> <span m="2070739">sum</span> <span m="2072060">of</span> <span m="2072389">all</span> <span m="2072630">of</span> <span m="2072750">the</span> <span m="2072929">edge</span> <span m="2073199">weights</span> <span m="2073560">from</span> <span m="2074520">vi</span> <span m="2075210">minus</span> <span m="2075630">1</span> <span m="2076500">to</span> <span m="2077580">vi,</span> <span m="2079080">for</span> <span m="2079469">i</span> <span m="2079980">equals</span> <span m="2080400">1</span> <span m="2080730">to</span> <span m="2080850">k.</span> <span m="2082949">This</span> <span m="2083159">is</span> <span m="2083340">poor</span> <span m="2083580">notation.</span> <span m="2084070">This</span> <span m="2084210">is</span> <span m="2084270">the</span> <span m="2084389">weight</span> <span m="2084840">of</span> <span m="2084960">the</span> <span m="2085080">edge</span> <span m="2085830">from</span> <span m="2086219">the</span> <span m="2086550">vi</span> <span m="2086790">minus</span> <span m="2087150">1</span> <span m="2087449">to</span> <span m="2087750">i.</span> <span m="2089300">And</span> <span m="2089480">we've</span> <span m="2089690">got--</span> <span m="2089900">it</span> <span m="2090350">indexes</span> <span m="2091010">from</span> <span m="2091370">1--</span> <span m="2093040">that's</span> <span m="2093310">the</span> <span m="2093400">first</span> <span m="2093730">edge--</span> <span m="2094600">to</span> <span m="2094840">k,</span> <span m="2095260">which</span> <span m="2095469">is</span> <span m="2095590">the</span> <span m="2095650">last</span> <span m="2095969">edge.</span> <span m="2097180">So</span> <span m="2097300">that's</span> <span m="2097570">the</span> <span m="2097660">weight</span> <span m="2097870">of</span> <span m="2097960">my</span> <span m="2098080">path.</span></p>
<p><span m="2099460">The</span> <span m="2099580">weight</span> <span m="2099760">of</span> <span m="2099850">my</span> <span m="2099970">transformed</span> <span m="2100690">path--</span> <span m="2101160">I'm</span> <span m="2101490">going to</span> <span m="2101830">do</span> <span m="2102010">it</span> <span m="2102070">down</span> <span m="2102310">here.</span> <span m="2102740">It's</span> <span m="2102880">a</span> <span m="2104870">little</span> <span m="2105250">iffy.</span> <span m="2106030">The</span> <span m="2106180">weight</span> <span m="2106450">of</span> <span m="2106540">my</span> <span m="2106660">transformed</span> <span m="2107200">path</span> <span m="2107560">I'm</span> <span m="2107680">going</span> <span m="2107800">to</span> <span m="2107860">say</span> <span m="2108100">is</span> <span m="2108220">the</span> <span m="2108340">weight</span> <span m="2108970">in</span> <span m="2109240">this</span> <span m="2109450">new</span> <span m="2110980">weighted</span> <span m="2111310">graph</span> <span m="2111670">G</span> <span m="2112630">prime.</span> <span m="2116390">This</span> <span m="2116630">weight</span> <span m="2116930">of</span> <span m="2117080">that</span> <span m="2117350">same</span> <span m="2117680">path--</span> <span m="2118310">it's</span> <span m="2118460">the</span> <span m="2118550">same</span> <span m="2118820">path--</span> <span m="2120470">is</span> <span m="2120680">just</span> <span m="2120860">going</span> <span m="2121010">to</span> <span m="2121100">be</span> <span m="2122300">the</span> <span m="2122450">sum</span> <span m="2124670">of</span> <span m="2124970">all</span> <span m="2125180">of</span> <span m="2125300">the</span> <span m="2125450">reweighted</span> <span m="2126080">edges.</span> <span m="2126510">So</span> <span m="2126770">i</span> <span m="2127340">equals</span> <span m="2127910">1</span> <span m="2128990">to</span> <span m="2129290">k</span> <span m="2133470">of</span> <span m="2134130">my</span> <span m="2134430">original</span> <span m="2134970">weight</span> <span m="2135510">of</span> <span m="2135690">my</span> <span m="2135900">edge,</span> <span m="2136650">so</span> <span m="2136920">from</span> <span m="2137700">0,</span> <span m="2138630">i</span> <span m="2138960">minus</span> <span m="2139350">1</span> <span m="2139740">to</span> <span m="2140130">vi.</span></p>
<p><span m="2143100">But</span> <span m="2143280">what</span> <span m="2143430">did</span> <span m="2143550">I</span> <span m="2143700">do?</span> <span m="2145310">This</span> <span m="2145850">edge</span> <span m="2146450">is</span> <span m="2146810">outgoing</span> <span m="2147650">from</span> <span m="2147890">vi</span> <span m="2148220">minus</span> <span m="2148550">1.</span> <span m="2149570">So</span> <span m="2150230">it's</span> <span m="2150500">outgoing,</span> <span m="2151070">so</span> <span m="2151220">I</span> <span m="2151370">add</span> <span m="2151910">that</span> <span m="2152180">weight--</span> <span m="2153140">that</span> <span m="2153320">potential,</span> <span m="2153890">sorry.</span> <span m="2159680">But</span> <span m="2159920">that</span> <span m="2160130">edge</span> <span m="2160340">is</span> <span m="2160460">also</span> <span m="2161240">incoming</span> <span m="2162710">into</span> <span m="2163160">vi.</span> <span m="2164450">So</span> <span m="2164600">when</span> <span m="2164780">I</span> <span m="2164870">reweighted</span> <span m="2165410">the</span> <span m="2165500">thing,</span> <span m="2166160">I</span> <span m="2166370">got</span> <span m="2166520">a</span> <span m="2166610">subtraction</span> <span m="2168290">of</span> <span m="2168680">h,</span> <span m="2171220">vi.</span></p>
<p><span m="2176850">Now,</span> <span m="2177090">what</span> <span m="2177240">happens</span> <span m="2177660">here</span> <span m="2177810">in</span> <span m="2177900">the</span> <span m="2177990">sum,</span> <span m="2179070">this</span> <span m="2179520">term,</span> <span m="2181020">if</span> <span m="2181230">I</span> <span m="2181320">just</span> <span m="2181530">took</span> <span m="2181740">the</span> <span m="2182010">sum</span> <span m="2182640">over</span> <span m="2182970">this</span> <span m="2183240">term,</span> <span m="2183780">that's</span> <span m="2184080">exactly</span> <span m="2184500">my</span> <span m="2184680">original</span> <span m="2185100">pathway.</span> <span m="2186500">So</span> <span m="2186630">that's</span> <span m="2186840">good.</span> <span m="2191280">But</span> <span m="2191420">you'll</span> <span m="2191540">notice</span> <span m="2191930">that</span> <span m="2192170">this</span> <span m="2193070">sum</span> <span m="2194240">has</span> <span m="2194600">k</span> <span m="2194900">terms,</span> <span m="2196510">and</span> <span m="2196810">this</span> <span m="2197240">sum</span> <span m="2198070">has</span> <span m="2198460">the</span> <span m="2198550">subtraction</span> <span m="2199240">of</span> <span m="2199360">k</span> <span m="2199600">other</span> <span m="2199870">terms.</span> <span m="2200830">But</span> <span m="2201070">most</span> <span m="2201760">of</span> <span m="2201910">these</span> <span m="2202240">terms</span> <span m="2203710">are</span> <span m="2203950">equal.</span></p>
<p><span m="2205450">Along</span> <span m="2205960">the</span> <span m="2206050">path,</span> <span m="2206980">all</span> <span m="2207310">the</span> <span m="2207610">incoming</span> <span m="2208180">and</span> <span m="2208300">outgoing</span> <span m="2208780">edges</span> <span m="2210790">cancel</span> <span m="2211270">out.</span> <span m="2212860">So</span> <span m="2213130">we're</span> <span m="2213280">left</span> <span m="2213610">with</span> <span m="2213820">only</span> <span m="2216000">adding</span> <span m="2217290">the</span> <span m="2217440">potential</span> <span m="2218070">at</span> <span m="2218250">the</span> <span m="2218490">starting</span> <span m="2218910">vertex</span> <span m="2220300">and</span> <span m="2220650">subtracting</span> <span m="2221670">the</span> <span m="2221790">potential</span> <span m="2222450">at</span> <span m="2222600">the</span> <span m="2222960">final</span> <span m="2223290">vertex.</span> <span m="2224000">So</span> <span m="2224220">we've</span> <span m="2224400">got,</span> <span m="2224640">add</span> <span m="2226200">h,</span> <span m="2227220">v0</span> <span m="2229170">minus</span> <span m="2229830">h,</span> <span m="2231240">vk.</span></p>
<p><span m="2235440">And</span> <span m="2235650">why</span> <span m="2235860">is</span> <span m="2235950">that</span> <span m="2236130">good?</span> <span m="2237780">Well,</span> <span m="2237960">that's</span> <span m="2238230">good</span> <span m="2238500">because</span> <span m="2239640">every</span> <span m="2240270">path</span> <span m="2241260">from</span> <span m="2241700">v0</span> <span m="2242490">to</span> <span m="2242670">vk</span> <span m="2244080">starts</span> <span m="2244890">at</span> <span m="2245030">v0</span> <span m="2245640">and</span> <span m="2245850">ends</span> <span m="2246120">at</span> <span m="2246240">vk.</span> <span m="2246900">That's</span> <span m="2247200">just--</span> <span m="2247620">that's</span> <span m="2247920">how</span> <span m="2248100">it</span> <span m="2248190">is.</span> <span m="2249390">That's</span> <span m="2249630">how</span> <span m="2249750">we've</span> <span m="2249930">defined</span> <span m="2250380">paths</span> <span m="2250830">going</span> <span m="2251130">from</span> <span m="2251385">v0</span> <span m="2251910">to</span> <span m="2252000">vk.</span> <span m="2253380">But</span> <span m="2253620">every</span> <span m="2254070">such</span> <span m="2254460">path,</span> <span m="2256800">we</span> <span m="2257010">transform</span> <span m="2257700">the</span> <span m="2257820">weight</span> <span m="2258060">of</span> <span m="2258180">that</span> <span m="2258330">path</span> <span m="2260760">by</span> <span m="2261180">adding</span> <span m="2261450">a</span> <span m="2261510">constant</span> <span m="2261990">associated</span> <span m="2262500">with</span> <span m="2262620">the</span> <span m="2262710">start</span> <span m="2263550">and</span> <span m="2263850">adding</span> <span m="2264420">this</span> <span m="2264660">value</span> <span m="2265020">associated</span> <span m="2265470">with</span> <span m="2265590">the</span> <span m="2265710">end.</span></p>
<p><span m="2266730">And</span> <span m="2266940">so</span> <span m="2267150">every</span> <span m="2267660">path</span> <span m="2268770">going</span> <span m="2269160">from</span> <span m="2269490">v0</span> <span m="2269760">to</span> <span m="2269850">vk</span> <span m="2270510">changes</span> <span m="2271140">by</span> <span m="2271350">the</span> <span m="2271440">same</span> <span m="2271710">amount.</span> <span m="2274060">And</span> <span m="2274300">so</span> <span m="2274600">if</span> <span m="2275050">this</span> <span m="2275360">path</span> <span m="2275770">pi</span> <span m="2277900">was</span> <span m="2278620">shortest,</span> <span m="2280330">it's</span> <span m="2280600">still</span> <span m="2280870">shortest</span> <span m="2281380">in</span> <span m="2281470">the</span> <span m="2281530">reweighted</span> <span m="2281980">graph</span> <span m="2282730">because</span> <span m="2283120">I've</span> <span m="2283270">just</span> <span m="2283480">changed</span> <span m="2283870">all</span> <span m="2284230">paths</span> <span m="2284830">between</span> <span m="2285220">those</span> <span m="2285430">two</span> <span m="2285580">vertices</span> <span m="2286030">by</span> <span m="2286150">the</span> <span m="2286240">same</span> <span m="2286540">amount.</span> <span m="2288140">This</span> <span m="2288280">is</span> <span m="2288370">kind</span> <span m="2288580">of</span> <span m="2288670">like</span> <span m="2288820">a</span> <span m="2288910">telescoping</span> <span m="2289690">argument</span> <span m="2290230">here</span> <span m="2291520">in</span> <span m="2292060">that</span> <span m="2292180">kind</span> <span m="2292360">of</span> <span m="2292420">proof.</span></p>
<p><span m="2292690">Right.</span> <span m="2292940">So</span> <span m="2293740">we</span> <span m="2293980">have,</span> <span m="2295780">the</span> <span m="2295960">weight</span> <span m="2296860">changes.</span> <span m="2298210">It</span> <span m="2298270">could</span> <span m="2298480">change,</span> <span m="2299470">but</span> <span m="2299650">it</span> <span m="2299740">changes</span> <span m="2300130">all</span> <span m="2300430">paths</span> <span m="2301240">between</span> <span m="2301720">these</span> <span m="2301900">two</span> <span m="2302050">vertices</span> <span m="2302500">by</span> <span m="2302620">the</span> <span m="2302740">same</span> <span m="2303070">amount,</span> <span m="2304680">which</span> <span m="2304850">means</span> <span m="2305150">that</span> <span m="2305330">shortest</span> <span m="2305690">paths</span> <span m="2305960">are</span> <span m="2306050">still</span> <span m="2306350">shortest.</span> <span m="2308000">Awesome.</span></p>
<p><span m="2309540">OK,</span> <span m="2311310">so</span> <span m="2313300">the</span> <span m="2313480">name</span> <span m="2313780">of</span> <span m="2313840">the</span> <span m="2313960">game</span> <span m="2314290">here</span> <span m="2315430">is</span> <span m="2315760">now,</span> <span m="2316390">we</span> <span m="2316630">have</span> <span m="2316870">this</span> <span m="2317170">really</span> <span m="2317500">flexible</span> <span m="2318100">tool.</span> <span m="2319330">We</span> <span m="2319420">have</span> <span m="2319540">this</span> <span m="2319750">tool</span> <span m="2320530">where</span> <span m="2320980">we</span> <span m="2321160">can</span> <span m="2321970">add</span> <span m="2322360">or</span> <span m="2322450">subtract</span> <span m="2323530">weight</span> <span m="2323950">from</span> <span m="2324190">various</span> <span m="2324640">edges.</span> <span m="2325360">But</span> <span m="2325540">we</span> <span m="2325630">have</span> <span m="2325780">to</span> <span m="2325870">do</span> <span m="2326050">so</span> <span m="2326260">in</span> <span m="2326350">a</span> <span m="2326380">kind</span> <span m="2326620">of</span> <span m="2326950">localized,</span> <span m="2327640">constrained</span> <span m="2328180">way.</span> <span m="2328670">We</span> <span m="2328750">have</span> <span m="2328870">to</span> <span m="2328960">do</span> <span m="2329080">the</span> <span m="2329170">same</span> <span m="2329560">thing</span> <span m="2330490">around</span> <span m="2331150">each</span> <span m="2331360">vertex.</span> <span m="2332870">But</span> <span m="2332950">it</span> <span m="2333010">seems</span> <span m="2333280">like</span> <span m="2333430">a</span> <span m="2333490">powerful</span> <span m="2333970">transformation</span> <span m="2334660">technique</span> <span m="2335260">that</span> <span m="2335470">maybe</span> <span m="2335890">we</span> <span m="2336040">can</span> <span m="2336190">get</span> <span m="2336430">this</span> <span m="2337420">thing</span> <span m="2337660">that</span> <span m="2337810">we</span> <span m="2337930">want,</span> <span m="2338750">which</span> <span m="2338920">is</span> <span m="2339100">a</span> <span m="2339190">G</span> <span m="2339460">prime,</span> <span m="2340150">a</span> <span m="2340300">reweighting</span> <span m="2340780">of</span> <span m="2340870">the</span> <span m="2340960">graph</span> <span m="2341290">where</span> <span m="2341380">all</span> <span m="2341500">the</span> <span m="2341620">edge</span> <span m="2341830">weights</span> <span m="2342070">are</span> <span m="2342190">positive</span> <span m="2343750">or</span> <span m="2343930">non-negative.</span></p>
<p><span m="2347130">So</span> <span m="2348120">does</span> <span m="2348450">there</span> <span m="2348660">exist</span> <span m="2349890">an</span> <span m="2350190">h</span> <span m="2351210">such</span> <span m="2351660">that</span> <span m="2355200">the</span> <span m="2355410">weights</span> <span m="2355830">are</span> <span m="2355920">all</span> <span m="2356040">positive?</span> <span m="2356710">What</span> <span m="2356730">does</span> <span m="2356850">that</span> <span m="2357030">mean?</span> <span m="2357720">w</span> <span m="2358200">prime</span> <span m="2359190">u,</span> <span m="2359580">v,</span> <span m="2363270">the</span> <span m="2363480">weight</span> <span m="2363840">in</span> <span m="2364080">my</span> <span m="2364230">new</span> <span m="2364440">graph,</span> <span m="2364785">in</span> <span m="2365130">G</span> <span m="2365580">prime,</span> <span m="2368540">I</span> <span m="2368750">want</span> <span m="2369020">these</span> <span m="2371030">modified</span> <span m="2371750">weights,</span> <span m="2375410">this</span> <span m="2375650">modified</span> <span m="2376250">weight</span> <span m="2376520">of</span> <span m="2376670">my</span> <span m="2376850">graph,</span> <span m="2377690">I</span> <span m="2377840">want</span> <span m="2378020">each</span> <span m="2378200">of</span> <span m="2378320">these</span> <span m="2378560">to</span> <span m="2378650">be</span> <span m="2380420">non-negative.</span> <span m="2383280">So</span> <span m="2383520">does</span> <span m="2383820">there</span> <span m="2384000">exist</span> <span m="2384330">such</span> <span m="2384600">a</span> <span m="2384630">thing?</span> <span m="2386271">Huh.</span></p>
<p><span m="2387670">Well,</span> <span m="2387880">if</span> <span m="2388030">I</span> <span m="2388150">rearrange</span> <span m="2388840">this</span> <span m="2389050">equation</span> <span m="2389560">a</span> <span m="2389650">little</span> <span m="2389860">bit,</span> <span m="2390520">this</span> <span m="2390760">side,</span> <span m="2393370">I</span> <span m="2393580">get</span> <span m="2393790">something</span> <span m="2394210">that</span> <span m="2394360">looks</span> <span m="2394630">like</span> <span m="2394870">this.</span> <span m="2395695">h</span> <span m="2396010">of</span> <span m="2396340">v</span> <span m="2398280">needs</span> <span m="2398670">to</span> <span m="2398790">be</span> <span m="2399660">less</span> <span m="2400080">than</span> <span m="2400290">or</span> <span m="2400410">equal</span> <span m="2400770">to</span> <span m="2401670">h</span> <span m="2402180">of</span> <span m="2402330">u,</span> <span m="2404030">plus</span> <span m="2406380">the</span> <span m="2406530">weight</span> <span m="2406920">of</span> <span m="2407040">some</span> <span m="2407520">edge</span> <span m="2408060">from</span> <span m="2408330">u</span> <span m="2408570">to</span> <span m="2408730">v.</span> <span m="2413810">What</span> <span m="2413960">does</span> <span m="2414050">that</span> <span m="2414200">look</span> <span m="2414410">like?</span> <span m="2416450">That</span> <span m="2416660">looks</span> <span m="2417350">like</span> <span m="2417710">almost</span> <span m="2418160">exactly</span> <span m="2418700">the</span> <span m="2418790">definition</span> <span m="2419810">of</span> <span m="2420080">the</span> <span m="2420170">triangle</span> <span m="2420620">inequality.</span></p>
<p><span m="2424270">Shortest</span> <span m="2424870">path</span> <span m="2425320">from</span> <span m="2425530">some</span> <span m="2425770">vertex</span> <span m="2426340">here</span> <span m="2426670">and</span> <span m="2426790">its</span> <span m="2427180">shortest</span> <span m="2427660">path</span> <span m="2427990">distance</span> <span m="2428350">from</span> <span m="2428500">the</span> <span m="2428560">same</span> <span m="2428830">vertex</span> <span m="2429310">here,</span> <span m="2430210">this</span> <span m="2430420">is</span> <span m="2430570">just</span> <span m="2430930">a</span> <span m="2430960">statement</span> <span m="2431830">of</span> <span m="2432010">the</span> <span m="2432160">triangle</span> <span m="2432580">inequality.</span> <span m="2435660">So</span> <span m="2436140">if</span> <span m="2436350">we</span> <span m="2436500">can</span> <span m="2436710">set</span> <span m="2437100">these</span> <span m="2437400">h's</span> <span m="2437910">to</span> <span m="2438060">be</span> <span m="2438510">the</span> <span m="2438660">shortest</span> <span m="2439050">path</span> <span m="2439320">distance</span> <span m="2439770">from</span> <span m="2439920">some</span> <span m="2440130">vertex</span> <span m="2440980">and</span> <span m="2441090">those</span> <span m="2441270">shortest</span> <span m="2441570">path</span> <span m="2441810">distances</span> <span m="2442320">are</span> <span m="2442410">finite,</span> <span m="2446210">and</span> <span m="2447230">not</span> <span m="2447800">minus</span> <span m="2448130">infinity,</span> <span m="2449570">then</span> <span m="2451100">this</span> <span m="2452120">thing</span> <span m="2452480">will</span> <span m="2452690">hold</span> <span m="2453170">by</span> <span m="2453410">triangle</span> <span m="2453830">inequality.</span> <span m="2454370">And</span> <span m="2454490">in</span> <span m="2454580">particular,</span> <span m="2455520">if</span> <span m="2455660">we</span> <span m="2455810">were</span> <span m="2455900">to</span> <span m="2455990">reweight</span> <span m="2456950">the</span> <span m="2457100">edges</span> <span m="2457880">based</span> <span m="2458360">on</span> <span m="2458510">those</span> <span m="2458690">values</span> <span m="2459080">of</span> <span m="2459200">h,</span> <span m="2460100">then</span> <span m="2460310">we</span> <span m="2460460">get</span> <span m="2460970">new</span> <span m="2461300">edge</span> <span m="2461480">rates</span> <span m="2461780">that</span> <span m="2461930">are</span> <span m="2461990">non-negative.</span></p>
<p><span m="2464630">Awesome.</span> <span m="2465740">OK.</span> <span m="2467380">But</span> <span m="2467770">there</span> <span m="2468010">might</span> <span m="2468520">not</span> <span m="2468820">be</span> <span m="2469240">any</span> <span m="2469510">vertex</span> <span m="2471040">from</span> <span m="2471340">which</span> <span m="2471550">we</span> <span m="2471700">can</span> <span m="2472090">access,</span> <span m="2473500">which</span> <span m="2473770">we</span> <span m="2473890">can</span> <span m="2474040">reach</span> <span m="2475000">all</span> <span m="2475300">vertices</span> <span m="2475870">in</span> <span m="2475960">the</span> <span m="2476050">graph.</span> <span m="2476920">In</span> <span m="2477160">particular,</span> <span m="2477760">my</span> <span m="2477910">graph</span> <span m="2478210">might</span> <span m="2478540">not</span> <span m="2478750">even</span> <span m="2478930">be</span> <span m="2479050">connected.</span> <span m="2484350">If</span> <span m="2484620">I</span> <span m="2484710">want</span> <span m="2484950">this</span> <span m="2485130">property,</span> <span m="2485700">I</span> <span m="2485850">need</span> <span m="2486420">all</span> <span m="2486750">of</span> <span m="2486870">these--</span> <span m="2487170">I</span> <span m="2487470">don't</span> <span m="2487650">gain</span> <span m="2487950">any</span> <span m="2488160">information</span> <span m="2488820">if</span> <span m="2488970">these</span> <span m="2489180">things</span> <span m="2489420">are</span> <span m="2489540">infinite.</span> <span m="2492780">It's</span> <span m="2493680">exhaustively</span> <span m="2494520">true.</span> <span m="2494940">Infinity</span> <span m="2496050">is--</span> <span m="2496890">I</span> <span m="2497250">don't</span> <span m="2497430">even</span> <span m="2497580">know</span> <span m="2497700">how</span> <span m="2497760">to</span> <span m="2497850">compare</span> <span m="2498270">infinity</span> <span m="2499320">and</span> <span m="2499620">infinity</span> <span m="2500190">plus</span> <span m="2500540">a</span> <span m="2500886">constant.</span> <span m="2501580">I</span> <span m="2502140">don't</span> <span m="2502290">know.</span></p>
<p><span m="2504270">So</span> <span m="2504450">I</span> <span m="2504540">need</span> <span m="2504750">all</span> <span m="2504930">of</span> <span m="2505020">these</span> <span m="2505200">things</span> <span m="2505440">to</span> <span m="2505530">be</span> <span m="2505650">finite.</span> <span m="2506560">So</span> <span m="2506680">how</span> <span m="2506820">can</span> <span m="2506970">I</span> <span m="2507060">make</span> <span m="2507300">those</span> <span m="2507480">things</span> <span m="2507690">finite?</span> <span m="2509310">So</span> <span m="2509610">here's</span> <span m="2509910">the</span> <span m="2510000">next</span> <span m="2510420">idea.</span> <span m="2520740">Add</span> <span m="2524280">new</span> <span m="2525360">vertex</span> <span m="2527880">s</span> <span m="2530780">with</span> <span m="2532790">0-weight</span> <span m="2533690">edge</span> <span m="2538500">to</span> <span m="2539580">every</span> <span m="2541620">vertex,</span> <span m="2545750">V</span> <span m="2546170">in</span> <span m="2546455">V.</span> <span m="2548180">We</span> <span m="2548330">take</span> <span m="2548630">our</span> <span m="2548780">original</span> <span m="2549230">graph.</span> <span m="2550250">We</span> <span m="2550460">add</span> <span m="2550730">a</span> <span m="2550790">new</span> <span m="2551510">super</span> <span m="2551960">node</span> <span m="2552290">or</span> <span m="2552380">auxiliary</span> <span m="2552920">vertex</span> <span m="2553460">s,</span> <span m="2554240">with</span> <span m="2554480">a</span> <span m="2554540">0-weight</span> <span m="2555230">edge</span> <span m="2555620">to</span> <span m="2555770">every</span> <span m="2556160">vertex</span> <span m="2556610">in</span> <span m="2556700">my</span> <span m="2556850">graph.</span></p>
<p><span m="2557600">What</span> <span m="2557780">does</span> <span m="2557870">that</span> <span m="2558020">look</span> <span m="2558170">like?</span> <span m="2558510">This</span> <span m="2558590">is</span> <span m="2558740">like--</span> <span m="2559310">there's</span> <span m="2559640">my</span> <span m="2559790">original</span> <span m="2560150">graph,</span> <span m="2562260">and</span> <span m="2562470">now</span> <span m="2562680">I</span> <span m="2562740">have</span> <span m="2562890">this</span> <span m="2563850">vertex</span> <span m="2564480">s.</span> <span m="2565260">But</span> <span m="2565470">it</span> <span m="2565530">has</span> <span m="2566100">directed</span> <span m="2566700">edges</span> <span m="2567270">into</span> <span m="2567630">all</span> <span m="2567870">of</span> <span m="2567960">the</span> <span m="2568050">vertices</span> <span m="2569160">with</span> <span m="2569430">0-weight.</span> <span m="2571820">That's</span> <span m="2572120">our</span> <span m="2572210">picture.</span> <span m="2572930">And</span> <span m="2573170">this</span> <span m="2573380">new</span> <span m="2573650">thing</span> <span m="2579820">I'm</span> <span m="2579990">going</span> <span m="2580110">to</span> <span m="2580170">call,</span> <span m="2580470">maybe,</span> <span m="2581520">my</span> <span m="2582120">s</span> <span m="2582750">graph</span> <span m="2583200">now.</span></p>
<p><span m="2587740">And</span> <span m="2587950">the</span> <span m="2588040">claim</span> <span m="2588490">is,</span> <span m="2589930">well</span> <span m="2590230">now,</span> <span m="2590560">if</span> <span m="2590740">I</span> <span m="2590860">run</span> <span m="2592600">some</span> <span m="2592930">shortest</span> <span m="2593200">path</span> <span m="2593630">algorithm,</span> <span m="2594160">single</span> <span m="2594490">source</span> <span m="2594760">shortest</span> <span m="2595060">path</span> <span m="2595300">algorithm</span> <span m="2595690">this</span> <span m="2595900">time,</span> <span m="2596710">from</span> <span m="2597130">s</span> <span m="2597550">to</span> <span m="2597700">compute</span> <span m="2598510">the</span> <span m="2598660">shortest</span> <span m="2599230">path</span> <span m="2599560">distance</span> <span m="2600100">to</span> <span m="2600220">all</span> <span m="2600490">of</span> <span m="2600610">the</span> <span m="2600700">vertices,</span> <span m="2604770">the</span> <span m="2604980">shortest</span> <span m="2605520">distance</span> <span m="2606000">to</span> <span m="2606150">each</span> <span m="2606510">of</span> <span m="2606600">the</span> <span m="2606720">vertices</span> <span m="2608070">can't</span> <span m="2608430">be</span> <span m="2608550">positive,</span> <span m="2611310">because</span> <span m="2612890">there's</span> <span m="2613190">a</span> <span m="2613250">0-weight</span> <span m="2613880">edge.</span> <span m="2614090">So</span> <span m="2614360">a</span> <span m="2614420">minimum</span> <span m="2614930">weight</span> <span m="2615140">path</span> <span m="2615830">is</span> <span m="2616070">going</span> <span m="2616190">to</span> <span m="2616280">be</span> <span m="2616880">no</span> <span m="2617330">bigger</span> <span m="2617690">than</span> <span m="2617840">0.</span> <span m="2620890">If</span> <span m="2621160">it's</span> <span m="2621310">finite,</span> <span m="2621950">then</span> <span m="2622000">there's</span> <span m="2622240">a</span> <span m="2622300">finite</span> <span m="2622690">length</span> <span m="2622900">shortest</span> <span m="2623200">path.</span> <span m="2623470">If</span> <span m="2623590">it's</span> <span m="2624040">minus</span> <span m="2624550">infinity,</span> <span m="2626100">then</span> <span m="2626490">there's</span> <span m="2626790">a</span> <span m="2626820">negative</span> <span m="2627120">rate</span> <span m="2627240">cycle</span> <span m="2627640">in my</span> <span m="2627780">graph</span> <span m="2628110">and</span> <span m="2628200">I</span> <span m="2628290">can</span> <span m="2628410">stop.</span></p>
<p><span m="2631290">So</span> <span m="2634540">there</span> <span m="2634750">are</span> <span m="2634810">either</span> <span m="2635950">two</span> <span m="2636190">situations.</span> <span m="2638050">If</span> <span m="2640580">delta</span> <span m="2641210">s,v</span> <span m="2642830">equals</span> <span m="2643280">minus</span> <span m="2643670">infinity--</span> <span m="2645090">so</span> <span m="2646100">I</span> <span m="2646280">guess</span> <span m="2646460">this</span> <span m="2646670">is,</span> <span m="2647900">run</span> <span m="2651350">single</span> <span m="2651770">source</span> <span m="2652070">shortest</span> <span m="2652400">paths</span> <span m="2653630">from</span> <span m="2656480">s.</span> <span m="2658290">And</span> <span m="2658650">really,</span> <span m="2659190">because</span> <span m="2659610">this</span> <span m="2659790">graph</span> <span m="2660480">could</span> <span m="2660750">contain</span> <span m="2661140">negative</span> <span m="2661500">edge</span> <span m="2661920">weights and</span> <span m="2662040">could</span> <span m="2662220">contain</span> <span m="2662520">negative</span> <span m="2662820">cycles,</span> <span m="2664170">we</span> <span m="2664350">can't</span> <span m="2664530">really</span> <span m="2664740">do</span> <span m="2664890">better</span> <span m="2665160">than</span> <span m="2665310">running</span> <span m="2665880">Bellman-Ford</span> <span m="2666660">here</span> <span m="2668040">from</span> <span m="2668430">s</span> <span m="2668850">to</span> <span m="2669000">compute</span> <span m="2669330">these</span> <span m="2669510">paths.</span> <span m="2670260">If</span> <span m="2671160">there</span> <span m="2671430">exists</span> <span m="2672300">in</span> <span m="2672600">this</span> <span m="2672810">new</span> <span m="2673080">graph</span> <span m="2673770">this</span> <span m="2674100">Gs,</span> <span m="2675420">if</span> <span m="2675660">there</span> <span m="2675840">exists</span> <span m="2676890">a</span> <span m="2677100">vertex</span> <span m="2677610">that</span> <span m="2677820">has</span> <span m="2678300">negative</span> <span m="2679770">infinite</span> <span m="2680520">weight</span> <span m="2681210">in</span> <span m="2681540">the</span> <span m="2682320">reweighted</span> <span m="2683010">graph--</span> <span m="2685560">sorry,</span> <span m="2689230">in</span> <span m="2689410">the</span> <span m="2689500">original</span> <span m="2689920">graph</span> <span m="2690400">G--</span> <span m="2690880">G</span> <span m="2691360">hasn't</span> <span m="2691660">been</span> <span m="2691810">reweighted</span> <span m="2692260">yet.</span> <span m="2693490">If</span> <span m="2693790">there's</span> <span m="2694000">a</span> <span m="2694060">negative</span> <span m="2694480">weight</span> <span m="2694780">distance</span> <span m="2695350">from</span> <span m="2695680">s,</span> <span m="2701380">then</span> <span m="2701680">there</span> <span m="2701830">was</span> <span m="2701950">a</span> <span m="2702010">negative</span> <span m="2702430">weight</span> <span m="2702640">cycle</span> <span m="2707530">in</span> <span m="2708070">the</span> <span m="2708220">original</span> <span m="2708640">graph.</span></p>
<p><span m="2709030">Why</span> <span m="2709270">is</span> <span m="2709390">that?</span> <span m="2710950">Well,</span> <span m="2711970">if</span> <span m="2712330">this</span> <span m="2712540">was</span> <span m="2712660">set</span> <span m="2712870">to</span> <span m="2712990">minus</span> <span m="2713320">infinity,</span> <span m="2714010">then</span> <span m="2714220">there</span> <span m="2714370">is</span> <span m="2714580">some</span> <span m="2715570">negative</span> <span m="2716050">weight</span> <span m="2716230">cycle</span> <span m="2716620">in</span> <span m="2716710">the</span> <span m="2716800">graph.</span> <span m="2718300">The</span> <span m="2718450">worry</span> <span m="2718810">is</span> <span m="2719230">that</span> <span m="2719440">that</span> <span m="2719620">negative</span> <span m="2719980">weight</span> <span m="2720190">cycle</span> <span m="2721060">was</span> <span m="2722080">added</span> <span m="2722590">to</span> <span m="2722740">my</span> <span m="2722920">graph</span> <span m="2723310">by</span> <span m="2723550">adding</span> <span m="2724030">this</span> <span m="2725410">vertex</span> <span m="2726040">s.</span> <span m="2727030">But</span> <span m="2727240">what</span> <span m="2727420">do</span> <span m="2727510">I</span> <span m="2727570">know</span> <span m="2727720">about</span> <span m="2728020">vertex</span> <span m="2728490">s?</span> <span m="2729520">It</span> <span m="2729760">has</span> <span m="2729970">no</span> <span m="2730150">incoming</span> <span m="2730630">edges.</span> <span m="2731290">So</span> <span m="2731470">no</span> <span m="2731920">negative</span> <span m="2732310">weight</span> <span m="2732490">cycle</span> <span m="2732880">could</span> <span m="2733030">go</span> <span m="2733180">through</span> <span m="2733660">s.</span> <span m="2735430">So</span> <span m="2735610">any</span> <span m="2735880">negative weight</span> <span m="2736360">cycle</span> <span m="2736990">was</span> <span m="2737290">in</span> <span m="2737410">the</span> <span m="2737500">original</span> <span m="2737950">graph,</span> <span m="2738610">and</span> <span m="2738820">so</span> <span m="2739000">I</span> <span m="2739090">can</span> <span m="2739240">abort.</span> <span m="2741420">Abort.</span> <span m="2743490">Yay.</span></p>
<p><span m="2745050">Otherwise,</span> <span m="2750130">what</span> <span m="2750340">do</span> <span m="2750430">I</span> <span m="2750550">do?</span> <span m="2751550">Well,</span> <span m="2752470">I</span> <span m="2752710">know</span> <span m="2752890">the</span> <span m="2753020">shortest</span> <span m="2753400">path</span> <span m="2753640">distances</span> <span m="2754510">here</span> <span m="2756710">would</span> <span m="2756980">satisfy</span> <span m="2757520">the</span> <span m="2757610">triangle</span> <span m="2758060">inequality.</span> <span m="2760520">So</span> <span m="2760850">if</span> <span m="2761210">I</span> <span m="2762200">reweight</span> <span m="2770560">with</span> <span m="2773110">h</span> <span m="2773620">of</span> <span m="2773905">v</span> <span m="2774850">equal</span> <span m="2775270">to</span> <span m="2775570">delta</span> <span m="2776230">s</span> <span m="2776680">of</span> <span m="2777130">v,</span> <span m="2778960">if</span> <span m="2779200">we</span> <span m="2779350">set</span> <span m="2779650">our</span> <span m="2779830">potentials</span> <span m="2780700">in</span> <span m="2780820">our</span> <span m="2780940">reweighted</span> <span m="2781510">graph</span> <span m="2782320">to</span> <span m="2782530">be</span> <span m="2783400">the</span> <span m="2783850">shortest</span> <span m="2784330">path</span> <span m="2784690">distance</span> <span m="2785170">from</span> <span m="2785500">our</span> <span m="2786040">super</span> <span m="2786580">node</span> <span m="2786880">s,</span> <span m="2788900">it</span> <span m="2789440">satisfies</span> <span m="2790220">the</span> <span m="2790970">triangle</span> <span m="2791390">inequality.</span> <span m="2795070">And</span> <span m="2795340">because</span> <span m="2795790">there's</span> <span m="2796060">no</span> <span m="2796600">negative</span> <span m="2797500">cycles,</span> <span m="2798490">all</span> <span m="2798790">of</span> <span m="2798880">these</span> <span m="2799030">values</span> <span m="2799480">are</span> <span m="2799840">finite.</span> <span m="2800950">And</span> <span m="2801190">then</span> <span m="2801880">this</span> <span m="2802150">reweighting</span> <span m="2802870">will</span> <span m="2802990">lead</span> <span m="2803230">to</span> <span m="2803380">a</span> <span m="2803470">graph</span> <span m="2804580">with</span> <span m="2805030">strictly--</span> <span m="2805840">or</span> <span m="2806230">not</span> <span m="2806500">strictly--</span> <span m="2808720">strictly</span> <span m="2809230">no</span> <span m="2809710">negative</span> <span m="2810130">weights</span> <span m="2810610">or</span> <span m="2812320">non-negative</span> <span m="2813280">weights.</span> <span m="2813700">OK,</span> <span m="2813970">great.</span></p>
<p><span m="2816440">So</span> <span m="2816620">that's</span> <span m="2816800">basically</span> <span m="2817350">it.</span> <span m="2819590">That's</span> <span m="2819820">the</span> <span m="2819940">idea</span> <span m="2820270">behind</span> <span m="2820690">Johnson's</span> <span m="2821170">algorithm.</span> <span m="2828620">It's</span> <span m="2828920">really</span> <span m="2830060">a</span> <span m="2830210">reduction</span> <span m="2830780">problem</span> <span m="2831260">or a</span> <span m="2831440">reduction</span> <span m="2831890">algorithm.</span> <span m="2832550">We</span> <span m="2832790">reducing</span> <span m="2833480">from</span> <span m="2834650">solving</span> <span m="2836300">kind</span> <span m="2836570">of</span> <span m="2836660">signed</span> <span m="2838070">all-pairs</span> <span m="2838580">shortest</span> <span m="2838880">paths,</span> <span m="2839330">graphs</span> <span m="2839870">where</span> <span m="2840470">their</span> <span m="2840740">weights</span> <span m="2841100">could</span> <span m="2841340">be</span> <span m="2841460">positive</span> <span m="2841910">or</span> <span m="2842060">negative,</span> <span m="2843790">and</span> <span m="2844020">we're</span> <span m="2844230">reducing</span> <span m="2845100">to</span> <span m="2846390">creating</span> <span m="2847050">a</span> <span m="2847110">graph</span> <span m="2847590">that</span> <span m="2847770">has</span> <span m="2848010">the</span> <span m="2848100">same</span> <span m="2848400">shortest</span> <span m="2848730">paths</span> <span m="2849030">properties,</span> <span m="2850590">but</span> <span m="2850800">only</span> <span m="2851070">has</span> <span m="2851370">non-negative</span> <span m="2851670">edge</span> <span m="2851970">weights.</span> <span m="2852360">So</span> <span m="2852540">we're</span> <span m="2852660">reducing</span> <span m="2853230">from</span> <span m="2853470">a</span> <span m="2853725">signed</span> <span m="2853980">context</span> <span m="2855060">to</span> <span m="2855250">a</span> <span m="2855300">non-negative</span> <span m="2856620">weight</span> <span m="2856950">context.</span></p>
<p><span m="2860700">So</span> <span m="2860970">Johnson's</span> <span m="2861450">algorithm,</span> <span m="2864810">what</span> <span m="2865020">are</span> <span m="2865110">the</span> <span m="2865200">steps?</span> <span m="2866130">Construct</span> <span m="2871240">Gs</span> <span m="2873730">from</span> <span m="2875380">G,</span> <span m="2879400">just</span> <span m="2879700">as</span> <span m="2879850">up</span> <span m="2880030">here.</span> <span m="2880840">I</span> <span m="2881710">make</span> <span m="2882070">a</span> <span m="2882160">new</span> <span m="2882400">vertex</span> <span m="2882920">s.</span> <span m="2884730">I</span> <span m="2884910">put</span> <span m="2885090">a</span> <span m="2885240">0</span> <span m="2885630">weight</span> <span m="2886020">directed</span> <span m="2886590">edge</span> <span m="2886890">from</span> <span m="2887190">s</span> <span m="2887460">to</span> <span m="2887610">every</span> <span m="2887850">vertex.</span> <span m="2889190">So</span> <span m="2889200">that's</span> <span m="2889380">the</span> <span m="2889470">first</span> <span m="2889710">step.</span></p>
<p><span m="2891390">Second</span> <span m="2891680">step--</span> <span m="2893930">compute</span> <span m="2896840">E,</span> <span m="2897320">s,v</span> <span m="2899570">for</span> <span m="2899840">all</span> <span m="2900650">V</span> <span m="2901250">in</span> <span m="2902240">V,</span> <span m="2904280">i.e--</span> <span m="2905690">or</span> <span m="2906440">e.g--</span> <span m="2907730">I</span> <span m="2907940">guess</span> <span m="2908810">really</span> <span m="2909200">it</span> <span m="2909320">should</span> <span m="2909500">be</span> <span m="2909640">i.e.</span> <span m="2910010">because</span> <span m="2910280">I</span> <span m="2910340">don't</span> <span m="2910520">really</span> <span m="2910700">have</span> <span m="2910790">another</span> <span m="2911060">option</span> <span m="2911450">here--</span> <span m="2911690">but</span> <span m="2912830">by</span> <span m="2915200">Bellman-Ford.</span> <span m="2919750">This</span> <span m="2919990">is</span> <span m="2920140">just</span> <span m="2920310">a</span> <span m="2920350">single</span> <span m="2920890">run</span> <span m="2921130">of</span> <span m="2921190">Bellman-Ford</span> <span m="2921850">here.</span> <span m="2924140">Compute.</span> <span m="2926270">And</span> <span m="2926450">then</span> <span m="2926600">there</span> <span m="2926720">are</span> <span m="2926810">two</span> <span m="2926990">possibilities.</span></p>
<p><span m="2929190">If</span> <span m="2931220">there</span> <span m="2931460">exists</span> <span m="2932690">a</span> <span m="2932930">delta</span> <span m="2933740">s,</span> <span m="2934220">v</span> <span m="2935360">that's</span> <span m="2935960">minus</span> <span m="2936440">infinity,</span> <span m="2944440">then</span> <span m="2945520">abort.</span> <span m="2949490">Else,</span> <span m="2954180">make--</span> <span m="2957800">or</span> <span m="2958190">reweight</span> <span m="2959150">the</span> <span m="2959630">graph</span> <span m="2960680">according</span> <span m="2961310">to</span> <span m="2962480">this</span> <span m="2962750">reweighting</span> <span m="2963290">scheme,</span> <span m="2967060">by</span> <span m="2968420">reweighting</span> <span m="2972670">each</span> <span m="2975370">edge</span> <span m="2977170">in</span> <span m="2977410">my</span> <span m="2977560">original</span> <span m="2978040">graph</span> <span m="2979330">to</span> <span m="2979540">have</span> <span m="2979870">weight--</span> <span m="2984130">our</span> <span m="2984370">new</span> <span m="2984580">weight,</span> <span m="2984920">which</span> <span m="2985030">is</span> <span m="2985180">our</span> <span m="2985390">old</span> <span m="2985810">weight,</span> <span m="2988180">plus</span> <span m="2988480">our</span> <span m="2988570">transformation.</span> <span m="2989410">Now,</span> <span m="2989920">our</span> <span m="2990100">transformation</span> <span m="2990820">is</span> <span m="2990970">now</span> <span m="2991120">going</span> <span m="2991270">to</span> <span m="2991330">set</span> <span m="2991690">h,</span> <span m="2992095">v</span> <span m="2992890">to</span> <span m="2993070">this</span> <span m="2993310">delta</span> <span m="2993760">s,</span> <span m="2994186">v.</span> <span m="2995770">So</span> <span m="2996190">I'm</span> <span m="2996370">going</span> <span m="2996580">to</span> <span m="2997330">add</span> <span m="2998710">delta</span> <span m="2999700">s,</span> <span m="3000630">u,</span> <span m="3001410">and</span> <span m="3001680">subtract</span> <span m="3002580">delta</span> <span m="3003420">s,</span> <span m="3003750">v.</span> <span m="3005370">That's</span> <span m="3005670">our</span> <span m="3006000">reweighting</span> <span m="3006300">scheme.</span> <span m="3006570">I'm</span> <span m="3006690">just</span> <span m="3006900">identifying</span> <span m="3008160">h,</span> <span m="3008610">v</span> <span m="3009270">with</span> <span m="3009570">this</span> <span m="3009780">shortest</span> <span m="3010170">path</span> <span m="3010470">distance</span> <span m="3010920">here.</span></p>
<p><span m="3016300">And</span> <span m="3016930">after</span> <span m="3017320">I</span> <span m="3017440">reweighted</span> <span m="3017890">that,</span> <span m="3018070">I</span> <span m="3018160">can</span> <span m="3018280">just</span> <span m="3020730">solve</span> <span m="3024070">all-pairs</span> <span m="3024590">shortest</span> <span m="3025000">paths</span> <span m="3027160">on</span> <span m="3028330">G</span> <span m="3028600">prime</span> <span m="3029830">with</span> <span m="3032000">Dijkstra.</span> <span m="3036170">And</span> <span m="3036410">then</span> <span m="3038600">compute</span> <span m="3043040">G</span> <span m="3043600">shortest</span> <span m="3044060">path</span> <span m="3045140">distances</span> <span m="3047060">from</span> <span m="3048860">G</span> <span m="3049130">prime</span> <span m="3050030">shortest</span> <span m="3050450">path</span> <span m="3052440">distances.</span> <span m="3057440">Compute</span> <span m="3058850">these</span> <span m="3059240">distances</span> <span m="3059840">from</span> <span m="3060050">the</span> <span m="3060140">other</span> <span m="3061910">using</span> <span m="3062300">this</span> <span m="3062480">algorithm</span> <span m="3063050">up</span> <span m="3063200">here--</span> <span m="3063470">can</span> <span m="3063830">compute</span> <span m="3064460">distances</span> <span m="3065090">in</span> <span m="3065210">G</span> <span m="3066260">from</span> <span m="3066590">distances</span> <span m="3066950">in</span> <span m="3067310">G</span> <span m="3067740">prime</span> <span m="3068900">in</span> <span m="3069290">linear</span> <span m="3069410">time--</span> <span m="3070640">or</span> <span m="3071090">sorry,</span> <span m="3072020">v</span> <span m="3072410">times</span> <span m="3072860">linear</span> <span m="3073220">time,</span> <span m="3074300">linear</span> <span m="3074660">time</span> <span m="3074990">for</span> <span m="3075380">each</span> <span m="3076310">s--</span> <span m="3077150">for</span> <span m="3077420">each</span> <span m="3077840">vertex</span> <span m="3078290">in</span> <span m="3078380">my</span> <span m="3078500">graph.</span></p>
<p><span m="3079460">OK,</span> <span m="3080480">so</span> <span m="3080750">that's</span> <span m="3080960">the</span> <span m="3081080">algorithm.</span> <span m="3082340">It's</span> <span m="3083540">basically,</span> <span m="3084140">correctness</span> <span m="3084890">is</span> <span m="3085250">trivial.</span> <span m="3086810">We</span> <span m="3087020">already</span> <span m="3087290">proved--</span> <span m="3088310">the</span> <span m="3088610">whole</span> <span m="3088880">part</span> <span m="3089210">of</span> <span m="3089270">this</span> <span m="3089450">lecture,</span> <span m="3089840">the</span> <span m="3089960">interesting</span> <span m="3090410">part</span> <span m="3090590">of</span> <span m="3090680">this</span> <span m="3090830">lecture</span> <span m="3091640">was</span> <span m="3091910">proving</span> <span m="3092420">that,</span> <span m="3092630">if</span> <span m="3092750">we</span> <span m="3092900">had</span> <span m="3093200">a</span> <span m="3093260">transformation</span> <span m="3094850">based</span> <span m="3095300">on</span> <span m="3095510">a</span> <span m="3095600">potential</span> <span m="3096140">function</span> <span m="3096770">that</span> <span m="3096980">changed</span> <span m="3097670">outgoing</span> <span m="3098330">edges</span> <span m="3099500">in</span> <span m="3099770">a</span> <span m="3099890">symmetrically</span> <span m="3100670">opposite</span> <span m="3101090">way</span> <span m="3101240">as</span> <span m="3101390">incoming</span> <span m="3101810">edges,</span> <span m="3103770">then</span> <span m="3104010">that</span> <span m="3104190">preserves</span> <span m="3104700">shortest</span> <span m="3105030">paths.</span> <span m="3107670">And</span> <span m="3107910">then</span> <span m="3108120">realizing</span> <span m="3108810">that</span> <span m="3110700">the</span> <span m="3110850">triangle</span> <span m="3111390">inequality</span> <span m="3114820">enforces</span> <span m="3115630">this</span> <span m="3115810">condition</span> <span m="3116470">that</span> <span m="3116740">edge</span> <span m="3116950">weights</span> <span m="3117550">will</span> <span m="3117730">be</span> <span m="3118960">non-negative</span> <span m="3119680">under</span> <span m="3119890">this</span> <span m="3120520">reweighting,</span> <span m="3124360">so</span> <span m="3124690">we</span> <span m="3125350">find</span> <span m="3125890">shortest</span> <span m="3126160">path</span> <span m="3126550">distances</span> <span m="3127120">from</span> <span m="3127330">some</span> <span m="3127630">other</span> <span m="3127930">arbitrary</span> <span m="3128530">vertex,</span> <span m="3129650">and</span> <span m="3129820">set</span> <span m="3130570">our</span> <span m="3130930">potential</span> <span m="3131440">functions</span> <span m="3131890">to</span> <span m="3132010">be</span> <span m="3132220">those</span> <span m="3132440">shortest</span> <span m="3132790">path</span> <span m="3133000">distance</span> <span m="3133360">weights.</span></p>
<p><span m="3134350">We</span> <span m="3134500">do</span> <span m="3134710">the</span> <span m="3134920">reweighting,</span> <span m="3136240">because</span> <span m="3136870">that</span> <span m="3137050">reweighting</span> <span m="3138010">preserves</span> <span m="3138630">shortest</span> <span m="3138940">paths,</span> <span m="3139300">which</span> <span m="3139480">we</span> <span m="3139630">already</span> <span m="3139960">argued.</span> <span m="3144000">Then</span> <span m="3144240">we</span> <span m="3144390">can</span> <span m="3144540">do--</span> <span m="3145020">then</span> <span m="3145650">this</span> <span m="3146010">has</span> <span m="3146370">positive</span> <span m="3146630">edge</span> <span m="3146890">weights,</span> <span m="3147270">so</span> <span m="3147600">Dijkstra</span> <span m="3148110">applies.</span> <span m="3149100">And</span> <span m="3149280">then</span> <span m="3149430">computing</span> <span m="3149940">this</span> <span m="3150210">takes</span> <span m="3150480">a</span> <span m="3150540">small</span> <span m="3150840">amount</span> <span m="3151050">of</span> <span m="3151110">time.</span></p>
<p><span m="3151420">OK,</span> <span m="3152010">what</span> <span m="3152250">is</span> <span m="3152370">the</span> <span m="3152850">running</span> <span m="3153210">time</span> <span m="3153450">of</span> <span m="3153510">this</span> <span m="3153690">algorithm?</span> <span m="3155230">So</span> <span m="3155340">this</span> <span m="3155580">part,</span> <span m="3156480">reconstructing</span> <span m="3157350">this</span> <span m="3157530">thing,</span> <span m="3158310">this</span> <span m="3158580">takes</span> <span m="3158940">linear</span> <span m="3159270">time.</span> <span m="3160210">I'm</span> <span m="3160320">just</span> <span m="3160500">adding.</span> <span m="3164250">I'm</span> <span m="3164460">just</span> <span m="3164640">making</span> <span m="3164970">a</span> <span m="3165030">new</span> <span m="3165240">graph</span> <span m="3166470">of</span> <span m="3166740">the</span> <span m="3166830">same</span> <span m="3167130">size,</span> <span m="3167490">except</span> <span m="3167850">I</span> <span m="3168000">added</span> <span m="3168390">v</span> <span m="3168870">edges</span> <span m="3169350">and</span> <span m="3169740">one</span> <span m="3169950">vertex.</span> <span m="3171810">Computing--</span> <span m="3173490">doing</span> <span m="3173910">Bellman-Ford</span> <span m="3174570">on</span> <span m="3174690">this</span> <span m="3174930">new</span> <span m="3175260">modified</span> <span m="3175770">graph,</span> <span m="3176490">that's</span> <span m="3176790">just--</span> <span m="3177570">I'm</span> <span m="3177810">doing</span> <span m="3178020">that</span> <span m="3178200">once.</span> <span m="3179280">That</span> <span m="3179520">takes</span> <span m="3179790">V</span> <span m="3180270">times</span> <span m="3180525">E</span> <span m="3180870">time.</span></p>
<p><span m="3184030">Doing</span> <span m="3184360">this</span> <span m="3184600">check,</span> <span m="3186670">that</span> <span m="3186940">just</span> <span m="3187150">takes--</span> <span m="3187390">I'm</span> <span m="3187630">looping</span> <span m="3187930">over</span> <span m="3188200">my</span> <span m="3188350">vertices.</span> <span m="3188830">That</span> <span m="3188980">just</span> <span m="3189220">takes</span> <span m="3189470">V</span> <span m="3189620">time.</span> <span m="3190720">Otherwise,</span> <span m="3193690">doing</span> <span m="3194020">this</span> <span m="3194380">reweighting,</span> <span m="3195940">I</span> <span m="3196150">change</span> <span m="3196510">the</span> <span m="3196600">weight</span> <span m="3196840">of</span> <span m="3196960">every</span> <span m="3197230">edge.</span> <span m="3198040">That</span> <span m="3198280">takes</span> <span m="3199150">order</span> <span m="3199510">E</span> <span m="3199720">time.</span> <span m="3203520">And</span> <span m="3203760">then</span> <span m="3203880">solving</span> <span m="3205170">G</span> <span m="3205710">prime--</span> <span m="3207570">solving</span> <span m="3208080">all-pairs</span> <span m="3208440">shortest</span> <span m="3208950">paths</span> <span m="3209520">on</span> <span m="3209850">the</span> <span m="3210180">modified</span> <span m="3210525">edge</span> <span m="3210870">weight</span> <span m="3211260">graph</span> <span m="3211830">with</span> <span m="3212100">Dijkstra</span> <span m="3212850">takes</span> <span m="3213210">V</span> <span m="3213450">times</span> <span m="3213840">Dijkstra.</span></p>
<p><span m="3215500">That's--</span> <span m="3218520">I</span> <span m="3218790">could use a</span> <span m="3218850">little</span> <span m="3219030">bit</span> <span m="3219180">more</span> <span m="3219360">board</span> <span m="3219570">space</span> <span m="3219900">here.</span> <span m="3220890">That's</span> <span m="3222750">V</span> <span m="3224350">times</span> <span m="3225850">V</span> <span m="3227860">log,</span> <span m="3230200">V</span> <span m="3231130">plus</span> <span m="3232210">E</span> <span m="3234880">time,</span> <span m="3236560">which</span> <span m="3236800">is</span> <span m="3236920">actually</span> <span m="3237220">the</span> <span m="3237310">running</span> <span m="3237580">time</span> <span m="3237820">that</span> <span m="3237970">we're</span> <span m="3238120">looking</span> <span m="3238450">for.</span> <span m="3239930">I</span> <span m="3240160">wanted</span> <span m="3240490">to</span> <span m="3240610">reduce</span> <span m="3241000">to</span> <span m="3241180">not</span> <span m="3241450">using</span> <span m="3241750">more</span> <span m="3241960">than</span> <span m="3242110">this</span> <span m="3242320">time.</span> <span m="3242890">We</span> <span m="3243070">used</span> <span m="3243310">this</span> <span m="3243520">amount</span> <span m="3243760">of</span> <span m="3243820">time.</span> <span m="3244520">Let's</span> <span m="3244720">make</span> <span m="3244930">sure</span> <span m="3245380">we</span> <span m="3245590">still</span> <span m="3245860">didn't</span> <span m="3246100">use</span> <span m="3246430">even</span> <span m="3246910">more.</span></p>
<p><span m="3248050">After</span> <span m="3248500">that,</span> <span m="3248740">we</span> <span m="3248890">compute</span> <span m="3250180">these</span> <span m="3250480">paths,</span> <span m="3251200">as</span> <span m="3251590">proofed</span> <span m="3251920">before,</span> <span m="3252790">in</span> <span m="3253840">V</span> <span m="3254290">times</span> <span m="3255820">V</span> <span m="3256270">plus</span> <span m="3256810">E,</span> <span m="3259020">which</span> <span m="3259320">is</span> <span m="3259380">smaller</span> <span m="3259800">than</span> <span m="3259950">that.</span> <span m="3261150">And</span> <span m="3261390">so</span> <span m="3261510">summing</span> <span m="3261930">up</span> <span m="3262110">all</span> <span m="3262290">of</span> <span m="3262380">these</span> <span m="3262560">running</span> <span m="3262860">times,</span> <span m="3264690">this</span> <span m="3264960">one</span> <span m="3265110">dominates.</span> <span m="3265840">And</span> <span m="3265860">so</span> <span m="3266580">Johnson's</span> <span m="3267600">can</span> <span m="3268080">solve</span> <span m="3268800">signed</span> <span m="3270240">weighted</span> <span m="3270960">all-pairs</span> <span m="3271650">shortest</span> <span m="3272010">paths,</span> <span m="3274420">signed</span> <span m="3274960">all-pairs</span> <span m="3275300">shortest</span> <span m="3275650">paths,</span> <span m="3276700">not</span> <span m="3277120">in</span> <span m="3278020">V</span> <span m="3278380">times</span> <span m="3278830">Bellman-Ford,</span> <span m="3279670">like</span> <span m="3279940">we</span> <span m="3280060">had</span> <span m="3280240">before</span> <span m="3281600">up</span> <span m="3281890">here,</span> <span m="3283810">but</span> <span m="3284050">faster,</span> <span m="3284890">in</span> <span m="3286630">nearly</span> <span m="3287260">linear</span> <span m="3288280">for</span> <span m="3288580">sparse</span> <span m="3288880">graphs,</span> <span m="3290830">just</span> <span m="3291070">without</span> <span m="3291370">this</span> <span m="3292060">log</span> <span m="3292450">factor.</span> <span m="3293180">So</span> <span m="3293260">we</span> <span m="3293380">got</span> <span m="3294070">quite</span> <span m="3294400">a</span> <span m="3294430">big</span> <span m="3294640">improvement.</span></p>
<p><span m="3298040">So</span> <span m="3298250">that's</span> <span m="3298460">the</span> <span m="3298550">nice</span> <span m="3298790">thing</span> <span m="3298970">about</span> <span m="3300380">all-pairs</span> <span m="3300950">shortest</span> <span m="3301340">paths</span> <span m="3302300">is</span> <span m="3302570">that,</span> <span m="3303410">really,</span> <span m="3303950">we</span> <span m="3304160">don't</span> <span m="3304520">have</span> <span m="3304790">to</span> <span m="3305000">incur</span> <span m="3305360">this</span> <span m="3306800">big</span> <span m="3307220">cost</span> <span m="3309050">in</span> <span m="3309290">the</span> <span m="3309350">context</span> <span m="3309860">of</span> <span m="3309950">negative</span> <span m="3310310">weights.</span> <span m="3311000">Essentially,</span> <span m="3312290">we</span> <span m="3312500">just</span> <span m="3312740">run</span> <span m="3312920">Bellman-Ford</span> <span m="3313550">once</span> <span m="3314180">to</span> <span m="3314390">see</span> <span m="3314630">if</span> <span m="3314750">there</span> <span m="3314930">is</span> <span m="3315110">a</span> <span m="3315170">negative</span> <span m="3315530">weight</span> <span m="3315710">cycle</span> <span m="3316040">in</span> <span m="3316130">my</span> <span m="3316250">graph.</span> <span m="3317090">If</span> <span m="3317360">it</span> <span m="3317480">is,</span> <span m="3317960">I</span> <span m="3318260">save</span> <span m="3318620">a</span> <span m="3318680">lot</span> <span m="3318890">of</span> <span m="3318980">work</span> <span m="3320090">by</span> <span m="3320330">stopping</span> <span m="3320810">early.</span></p>
<p><span m="3322460">So</span> <span m="3322670">that's</span> <span m="3322940">Johnson's.</span> <span m="3323600">That's</span> <span m="3323840">the</span> <span m="3323990">end</span> <span m="3324260">of</span> <span m="3324380">our</span> <span m="3324920">graphs</span> <span m="3325580">lectures.</span> <span m="3327440">We'll</span> <span m="3327710">be</span> <span m="3327830">having</span> <span m="3328070">a</span> <span m="3328160">review</span> <span m="3328610">and</span> <span m="3328730">problem</span> <span m="3329120">session</span> <span m="3330200">about</span> <span m="3330590">how</span> <span m="3330770">to</span> <span m="3331160">solve</span> <span m="3331670">problems,</span> <span m="3332510">graph</span> <span m="3332870">problems</span> <span m="3333680">using</span> <span m="3334070">this</span> <span m="3334220">material.</span> <span m="3336010">But</span> <span m="3336280">we've</span> <span m="3336940">talked</span> <span m="3337300">about</span> <span m="3337570">a</span> <span m="3337600">lot</span> <span m="3337840">of</span> <span m="3337900">different</span> <span m="3338200">things</span> <span m="3338630">so</span> <span m="3338740">far.</span> <span m="3338950">We've</span> <span m="3339100">talked</span> <span m="3339310">about</span> <span m="3339590">graph reachability,</span> <span m="3340630">connected</span> <span m="3341260">components,</span> <span m="3342640">detecting</span> <span m="3343180">cycles,</span> <span m="3343750">detecting</span> <span m="3344260">topological</span> <span m="3344920">sort</span> <span m="3345160">orders</span> <span m="3345580">of</span> <span m="3345700">a</span> <span m="3345850">DAG.</span></p>
<p><span m="3347430">We've</span> <span m="3347580">talked</span> <span m="3347790">about</span> <span m="3347970">finding</span> <span m="3348240">negative</span> <span m="3348600">weight</span> <span m="3348750">cycles,</span> <span m="3349500">single</span> <span m="3349920">source</span> <span m="3350250">shortest</span> <span m="3350580">path</span> <span m="3350910">algorithms,</span> <span m="3352230">and</span> <span m="3352470">now</span> <span m="3352800">finally,</span> <span m="3353520">today,</span> <span m="3354240">all-pairs</span> <span m="3354690">shortest</span> <span m="3355020">path</span> <span m="3355350">algorithms,</span> <span m="3356220">with</span> <span m="3356520">a</span> <span m="3356610">new</span> <span m="3356910">algorithm</span> <span m="3357430">that's</span> <span m="3357720">really</span> <span m="3357990">not</span> <span m="3359250">an</span> <span m="3360030">entirely</span> <span m="3360660">new</span> <span m="3360990">algorithm.</span> <span m="3361740">We</span> <span m="3361830">didn't</span> <span m="3362040">have</span> <span m="3362160">to</span> <span m="3362250">do</span> <span m="3362610">any</span> <span m="3363180">proof</span> <span m="3363570">by</span> <span m="3363780">induction</span> <span m="3364320">here.</span> <span m="3366160">Really,</span> <span m="3367000">the</span> <span m="3367270">heavy</span> <span m="3367630">work</span> <span m="3367960">that's</span> <span m="3368170">happening</span> <span m="3368860">is</span> <span m="3369130">we're</span> <span m="3369250">reducing</span> <span m="3369970">to</span> <span m="3370090">using</span> <span m="3370900">either</span> <span m="3371260">Dijkstra</span> <span m="3372130">or</span> <span m="3372310">Bellman-Ford</span> <span m="3373240">to</span> <span m="3373420">do</span> <span m="3373600">the</span> <span m="3373720">heavy</span> <span m="3374020">lifting</span> <span m="3374500">of</span> <span m="3374560">finding</span> <span m="3375220">single</span> <span m="3375670">source</span> <span m="3376270">shortest</span> <span m="3376660">paths</span> <span m="3377890">efficiently.</span> <span m="3379440">So</span> <span m="3379480">Johnson's</span> <span m="3379960">is</span> <span m="3380050">really</span> <span m="3380290">just</span> <span m="3380800">glue</span> <span m="3382150">to</span> <span m="3383350">transform</span> <span m="3384070">a</span> <span m="3384130">graph</span> <span m="3384520">in</span> <span m="3384610">a</span> <span m="3384670">clever</span> <span m="3385030">way,</span> <span m="3385840">and</span> <span m="3386050">then</span> <span m="3386200">reducing</span> <span m="3386740">to</span> <span m="3386830">using</span> <span m="3387130">some</span> <span m="3387310">of</span> <span m="3387400">the</span> <span m="3387550">shortest</span> <span m="3387880">paths</span> <span m="3388180">algorithms</span> <span m="3389020">faster.</span></p>
<p><span m="3390550">So</span> <span m="3390760">that's</span> <span m="3391060">our</span> <span m="3391210">unit</span> <span m="3391510">on</span> <span m="3391660">graphs.</span> <span m="3392770">Our</span> <span m="3392950">next</span> <span m="3393220">lecture,</span> <span m="3394000">we'll</span> <span m="3394390">start</span> <span m="3394900">talking</span> <span m="3395380">about</span> <span m="3395830">a</span> <span m="3396130">general</span> <span m="3396790">form</span> <span m="3397210">of,</span> <span m="3397870">not</span> <span m="3398260">presenting</span> <span m="3398860">you</span> <span m="3398950">with</span> <span m="3399070">an</span> <span m="3399190">algorithm,</span> <span m="3399880">but</span> <span m="3400300">how</span> <span m="3400570">to</span> <span m="3400660">design</span> <span m="3401050">your</span> <span m="3401170">own</span> <span m="3401380">algorithm</span> <span m="3402460">in</span> <span m="3402640">the</span> <span m="3402730">context</span> <span m="3403330">of</span> <span m="3403600">dynamic</span> <span m="3404050">programming.</span> <span m="3405310">So</span> <span m="3405490">see</span> <span m="3405610">you</span> <span m="3405670">next</span> <span m="3405880">lecture.</span></p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.006S20/MIT6_006S20_04_09_Lecture_14_300k.mp4">MP4 - 126MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/lecture-videos/lecture-14-apsp-and-johnson/EmSmaW-ud6A.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","00");googletag.pubads().set("CRS_END","6");googletag.pubads().set("SESSION","S");googletag.pubads().set("YEAR","20");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
